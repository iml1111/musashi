var Ls=Object.defineProperty;var Ts=(s,a,t)=>a in s?Ls(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var ns=(s,a,t)=>(Ts(s,typeof a!="symbol"?a+"":a,t),t);import{r as x,j as e,N as qe,L as _e,H as be,P as je,R as Is,u as As,M as zs,a as Ws,B as Ps,b as Os,C as _s,c as Ds,d as Ye,e as Bs,f as Xe,g as Hs,Q as Fs,h as Us,i as Rs,k as Vs,l as oe,m as qs}from"./react-vendor-7d02bedf.js";import{d as os}from"./dagre-a0030ada.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(l){if(l.ep)return;l.ep=!0;const n=t(l);fetch(l.href,n)}})();const ie="/api/v1";class Ks{constructor(){ns(this,"token",null);this.token=localStorage.getItem("access_token")}getHeaders(){const a={"Content-Type":"application/json"};return this.token&&(a.Authorization=`Bearer ${this.token}`),a}async login(a){console.log("Login attempt:",{username:a.username,password:a.password?"***":"empty"});const t=await fetch(`${ie}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(console.log("Login response status:",t.status),!t.ok){const l=await t.json().catch(()=>({detail:"Login failed"}));throw console.error("Login error:",l),new Error(l.detail||"Login failed")}const r=await t.json();return console.log("Login successful:",{user:r.user.username,role:r.user.role}),this.token=r.access_token,localStorage.setItem("access_token",r.access_token),r}async logout(){try{await fetch(`${ie}/auth/logout`,{method:"POST",headers:this.getHeaders()})}catch(a){console.warn("Logout request failed:",a)}finally{this.token=null,localStorage.removeItem("access_token")}}async getCurrentUser(){const a=await fetch(`${ie}/auth/me`,{headers:this.getHeaders()});if(!a.ok)throw new Error("Failed to get current user");return a.json()}async getAllUsers(){const a=await fetch(`${ie}/users/`,{headers:this.getHeaders()});if(!a.ok)throw new Error("Failed to get users");return a.json()}async createUser(a){const t=await fetch(`${ie}/users/`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)});if(!t.ok){const r=await t.json().catch(()=>({detail:"User creation failed"}));if(console.error("User creation error:",r),t.status===422&&r.detail){if(Array.isArray(r.detail)){const l=r.detail.map(n=>n.msg||n.message||JSON.stringify(n)).join(", ");throw new Error(l)}else if(typeof r.detail=="object")throw new Error(JSON.stringify(r.detail))}throw new Error(r.detail||"User creation failed")}return t.json()}async updateUser(a,t){const r=await fetch(`${ie}/users/me`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(t)});if(!r.ok){const l=await r.json().catch(()=>({detail:"User update failed"}));throw new Error(l.detail||"User update failed")}return r.json()}async adminUpdateUser(a,t){const r=await fetch(`${ie}/users/${a}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(t)});if(!r.ok){const l=await r.json().catch(()=>({detail:"User update failed"}));throw new Error(l.detail||"User update failed")}return r.json()}async deleteUser(a){const t=await fetch(`${ie}/users/${a}`,{method:"DELETE",headers:this.getHeaders()});if(!t.ok){const r=await t.json().catch(()=>({detail:"User deletion failed"}));throw new Error(r.detail||"User deletion failed")}}isAuthenticated(){return!!this.token}getToken(){return this.token}}const re=new Ks,us=x.createContext(void 0),Zs=({children:s})=>{const[a,t]=x.useState(null),[r,l]=x.useState(!0);x.useEffect(()=>{(async()=>{if(re.isAuthenticated())try{console.log("AuthContext: Token found, verifying with server");const j=await re.getCurrentUser();console.log("AuthContext: User verified:",j.username),t(j)}catch{console.log("AuthContext: Token invalid or expired, clearing session"),re.logout()}else console.log("AuthContext: No token found, user not authenticated");l(!1)})()},[]);const h={user:a,login:async(c,j)=>{try{l(!0),console.log("AuthContext: Starting login process");const g=await re.login({username:c,password:j});console.log("AuthContext: Login successful, setting user:",g.user),t(g.user)}catch(g){throw console.error("AuthContext: Login failed:",g),g}finally{l(!1)}},logout:()=>{re.logout(),t(null)},isLoading:r,isAuthenticated:!!a};return e.jsx(us.Provider,{value:h,children:s})},Fe=()=>{const s=x.useContext(us);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},fe=({children:s,requireAdmin:a=!1})=>{const{isAuthenticated:t,user:r,isLoading:l}=Fe();return console.log("ProtectedRoute:",{isAuthenticated:t,user:r?{username:r.username,role:r.role}:null,isLoading:l,requireAdmin:a}),l?(console.log("ProtectedRoute: Still loading, showing spinner"),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-musashi-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})})):t?a&&(r==null?void 0:r.role)!=="admin"?(console.log("ProtectedRoute: Admin required but user is not admin, redirecting to dashboard"),e.jsx(qe,{to:"/dashboard",replace:!0})):(console.log("ProtectedRoute: Access granted, rendering children"),e.jsx(e.Fragment,{children:s})):(console.log("ProtectedRoute: Not authenticated, redirecting to login"),e.jsx(qe,{to:"/login",replace:!0}))};var Gs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Js=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),O=(s,a)=>{const t=x.forwardRef(({color:r="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:d,children:o,...h},c)=>x.createElement("svg",{ref:c,...Gs,width:l,height:l,stroke:r,strokeWidth:d?Number(n)*24/Number(l):n,className:`lucide lucide-${Js(s)}`,...h},[...a.map(([j,g])=>x.createElement(j,g)),...(Array.isArray(o)?o:[o])||[]]));return t.displayName=`${s}`,t},Se=O("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Qs=O("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),ps=O("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Ys=O("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),gs=O("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Ue=O("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),fs=O("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Xs=O("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]),et=O("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),ys=O("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),es=O("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),ss=O("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),st=O("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),tt=O("CircuitBoard",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]]),ts=O("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),at=O("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),as=O("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),rt=O("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ve=O("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),rs=O("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]),bs=O("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),lt=O("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),is=O("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),nt=O("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),js=O("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),vs=O("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),ot=O("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),ws=O("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),we=O("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),it=O("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),ct=O("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),dt=O("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),mt=O("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),ht=O("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ns=O("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),ls=O("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),xt=O("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),Ke=O("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]),ut=O("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),$e=O("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),pt=O("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),Ne=O("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),he="/api/v1";class gt{getHeaders(){const a={"Content-Type":"application/json"},t=localStorage.getItem("access_token");return t&&(a.Authorization=`Bearer ${t}`),a}async getWorkflows(){const a=await fetch(`${he}/workflows`,{headers:this.getHeaders()});if(!a.ok)throw new Error("Failed to fetch workflows");return(await a.json()).map(r=>(r._id&&!r.id&&(r.id=r._id),r))}async getWorkflow(a){const t=await fetch(`${he}/workflows/${a}`,{headers:this.getHeaders()});if(!t.ok)throw new Error("Failed to fetch workflow");const r=await t.json();return r._id&&!r.id&&(r.id=r._id),r}async createWorkflow(a){const t=await fetch(`${he}/workflows`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)});if(!t.ok){const l=await t.json().catch(()=>({detail:"Workflow creation failed"}));throw new Error(l.detail||"Workflow creation failed")}const r=await t.json();return r._id&&!r.id&&(r.id=r._id),r}async updateWorkflow(a,t){const r=await fetch(`${he}/workflows/${a}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(t)});if(!r.ok){const n=await r.json().catch(()=>({detail:"Workflow update failed"}));throw new Error(n.detail||"Workflow update failed")}const l=await r.json();return l._id&&!l.id&&(l.id=l._id),l}async deleteWorkflow(a){const t=await fetch(`${he}/workflows/${a}`,{method:"DELETE",headers:this.getHeaders()});if(!t.ok){const r=await t.json().catch(()=>({detail:"Workflow deletion failed"}));throw new Error(r.detail||"Workflow deletion failed")}}async shareWorkflow(a){const t=await fetch(`${he}/workflows/${a}/share`,{method:"POST",headers:this.getHeaders()});if(!t.ok){const r=await t.json().catch(()=>({detail:"Failed to generate share link"}));throw new Error(r.detail||"Failed to generate share link")}return t.json()}async getSharedWorkflow(a){const t=await fetch(`${he}/workflows/shared/${a}`,{headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Shared workflow not found");const r=await t.json();return r._id&&!r.id&&(r.id=r._id),r}}const ye=new gt,ft=()=>{const{user:s,logout:a}=Fe(),[t,r]=x.useState([]),[l,n]=x.useState(!0),[d,o]=x.useState(null),[h,c]=x.useState(null),[j,g]=x.useState({show:!1,workflowId:null,workflowName:""}),[N,M]=x.useState({}),z=async()=>{try{n(!0);const p=await ye.getWorkflows();r(p)}catch(p){console.error("Failed to fetch workflows:",p),o(p instanceof Error?p.message:"Failed to fetch workflows")}finally{n(!1)}};x.useEffect(()=>{z()},[]);const w=p=>{g({show:!0,workflowId:p.id,workflowName:p.name})},u=()=>{g({show:!1,workflowId:null,workflowName:""})},C=async()=>{if(j.workflowId)try{c(j.workflowId),await ye.deleteWorkflow(j.workflowId),r(p=>p.filter(S=>S.id!==j.workflowId)),u()}catch(p){console.error("Failed to delete workflow:",p),alert("Failed to delete workflow. Please try again.")}finally{c(null)}},P=async p=>{var S,_;if(p.share_token||(S=N[p.id])!=null&&S.shareToken){const $=p.share_token||((_=N[p.id])==null?void 0:_.shareToken);await k(p.id,$);return}M($=>({...$,[p.id]:{loading:!0,copied:!1}}));try{const $=await ye.shareWorkflow(p.id);M(W=>({...W,[p.id]:{loading:!1,copied:!1,shareToken:$.share_token}})),r(W=>W.map(y=>y.id===p.id?{...y,share_token:$.share_token,is_public:$.is_public}:y)),await k(p.id,$.share_token)}catch($){console.error("Failed to generate share link:",$),alert("Failed to generate share link. Please try again."),M(W=>({...W,[p.id]:{loading:!1,copied:!1}}))}},k=async(p,S)=>{const _=`${window.location.origin}/shared/${S}`;try{await navigator.clipboard.writeText(_),M($=>({...$,[p]:{...$[p],copied:!0}})),setTimeout(()=>{M($=>({...$,[p]:{...$[p],copied:!1}}))},2e3)}catch($){console.error("Failed to copy to clipboard:",$);const W=document.createElement("textarea");W.value=_,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),M(y=>({...y,[p]:{...y[p],copied:!0}})),setTimeout(()=>{M(y=>({...y,[p]:{...y[p],copied:!1}}))},2e3)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[j.show&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Workflow"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",e.jsxs("span",{className:"font-semibold",children:['"',j.workflowName,'"']}),"?",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-red-600",children:"This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!!h,className:`px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white ${h?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:h?"Deleting...":"Delete"})]})]})}),e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Musashi"}),e.jsx("span",{className:"ml-3 text-sm text-gray-500",children:"Cut the code. Shape the flow."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsx("span",{children:s==null?void 0:s.username}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${(s==null?void 0:s.role)==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:s==null?void 0:s.role})]}),(s==null?void 0:s.role)==="admin"&&e.jsxs(_e,{to:"/admin",className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(ht,{className:"w-4 h-4 mr-2"}),"Admin"]}),e.jsxs(_e,{to:"/workflow/new",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-musashi-600 hover:bg-musashi-700",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"New Workflow"]}),e.jsxs("button",{onClick:a,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(nt,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Your Workflows"}),e.jsx("p",{className:"text-gray-600",children:"Design and manage your AI agent workflows"})]}),l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-musashi-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading workflows..."})]}):d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 mb-4",children:d}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-musashi-600 text-white rounded-md hover:bg-musashi-700",children:"Retry"})]}):t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ve,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No workflows"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new workflow."}),e.jsx("div",{className:"mt-6",children:e.jsxs(_e,{to:"/workflow/new",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-musashi-600 hover:bg-musashi-700",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"New Workflow"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(p=>{var S,_,$,W,y,Z;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:p.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:p.description||"No description"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Updated ",new Date(p.updated_at).toLocaleDateString()]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>P(p),disabled:(S=N[p.id])==null?void 0:S.loading,className:`p-1 transition-colors ${(_=N[p.id])!=null&&_.copied?"text-green-600":($=N[p.id])!=null&&$.loading?"text-gray-300":p.is_public?"text-blue-600 hover:text-blue-700":"text-gray-400 hover:text-gray-600"}`,title:(W=N[p.id])!=null&&W.copied?"Link copied!":p.is_public?"Copy share link":"Share",children:(y=N[p.id])!=null&&y.copied?e.jsx(es,{className:"w-4 h-4"}):(Z=N[p.id])!=null&&Z.loading?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-transparent rounded-full animate-spin"}):p.is_public?e.jsx(ts,{className:"w-4 h-4"}):e.jsx(Ns,{className:"w-4 h-4"})})})]}),e.jsxs("div",{className:"mt-4 flex space-x-3",children:[e.jsxs(_e,{to:`/workflow/${p.id}`,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs("button",{onClick:()=>w(p),disabled:h===p.id,className:`inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${h===p.id?"text-gray-400 bg-gray-100 cursor-not-allowed":"text-red-700 bg-white hover:bg-red-50 hover:border-red-300"}`,children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),h===p.id?"Deleting...":"Delete"]})]})]},p.id)})})]})]})},cs={userinput:e.jsx($e,{size:16}),agent:e.jsx(Ue,{size:16}),vectorstore:e.jsx(as,{size:16}),knowledgebase:e.jsx(gs,{size:16}),mcp:e.jsx(Ns,{size:16}),apicall:e.jsx(bs,{size:16}),router:e.jsx(rs,{size:16}),finaloutput:e.jsx(ys,{size:16}),default:e.jsx(fs,{size:16})},ue=({data:s,type:a})=>{const t={userinput:{background:"#dcfce7",border:"2px solid #22c55e",color:"#166534"},agent:{background:"#dbeafe",border:"2px solid #3b82f6",color:"#1d4ed8"},vectorstore:{background:"#e9d5ff",border:"2px solid #a855f7",color:"#7c3aed"},knowledgebase:{background:"#e0e7ff",border:"2px solid #6366f1",color:"#4f46e5"},mcp:{background:"#fce7f3",border:"2px solid #ec4899",color:"#db2777"},apicall:{background:"#ccfbf1",border:"2px solid #14b8a6",color:"#0f766e"},router:{background:"#fef3c7",border:"2px solid #f59e0b",color:"#d97706"},finaloutput:{background:"#f3f4f6",border:"2px solid #6b7280",color:"#374151"},default:{background:"#ffffff",border:"2px solid #e0e0e0",color:"#424242"}},r=t[a]||t.default;return e.jsxs("div",{style:{...r,padding:"12px 20px",borderRadius:"12px",fontSize:"14px",fontWeight:500,minWidth:"180px",textAlign:"center",position:"relative",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[e.jsx(be,{type:"target",position:je.Top,style:{background:"transparent",width:"10px",height:"10px",border:"none",top:"-5px"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[cs[a]||cs.default,e.jsx("span",{children:(s==null?void 0:s.label)||"Node"})]}),(s==null?void 0:s.memo)&&e.jsxs("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"4px",fontStyle:"italic",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.2"},title:s.memo,children:["📝 ",s.memo]})]}),e.jsx(be,{type:"source",position:je.Bottom,style:{background:"transparent",width:"10px",height:"10px",border:"none",bottom:"-5px"}})]})},yt=({data:s})=>{const a=(s==null?void 0:s.outputs)||[],t=Math.min(a.length,30);return e.jsxs("div",{style:{background:"#dcfce7",border:"2px solid #22c55e",color:"#166534",padding:"12px 20px",borderRadius:"12px",fontSize:"14px",fontWeight:500,minWidth:"180px",textAlign:"center",position:"relative",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[e.jsx(be,{type:"target",position:je.Top,style:{background:"transparent",width:"10px",height:"10px",border:"none",top:"-5px"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx($e,{size:16}),e.jsx("span",{children:(s==null?void 0:s.label)||"User Input"})]}),t>0&&e.jsxs("div",{style:{fontSize:"10px",opacity:.6,marginTop:"2px"},children:[t," output",t>1?"s":""]}),(s==null?void 0:s.memo)&&e.jsxs("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"4px",fontStyle:"italic",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.2"},title:s.memo,children:["📝 ",s.memo]})]}),a.slice(0,30).map((r,l)=>{const n=t>0?Math.min(20,200/(t+1)):0,d=t>0?-(t-1)*n/2:0;return e.jsx(be,{id:`output-${r.key}`,type:"source",position:je.Bottom,style:{background:"transparent",width:"8px",height:"8px",border:"none",bottom:"-5px",left:`calc(50% + ${d+l*n}px)`,transform:"translateX(-50%)"},title:`${r.key} (${r.type})`},`output-${l}`)})]})},bt=({data:s,id:a})=>{var h,c,j,g,N,M,z;const t=((c=(h=s==null?void 0:s.parameters)==null?void 0:h.model)==null?void 0:c.trim())||"",r=t.length>0,l=((N=(g=(j=s==null?void 0:s.parameters)==null?void 0:j.system_prompt)==null?void 0:g.trim())==null?void 0:N.length)>0,n=((z=(M=s==null?void 0:s.parameters)==null?void 0:M.tools)==null?void 0:z.filter(w=>w.enabled))||[],d={web_search:"🌐",api_call:"🔌",file_search:"📁",code_interpreter:"💻",image_generation:"🎨"},o=w=>{w.stopPropagation();const u=new CustomEvent("openSystemPromptModal",{detail:{nodeId:a,nodeName:(s==null?void 0:s.label)||"Agent",systemPrompt:s.parameters.system_prompt}});window.dispatchEvent(u)};return e.jsxs("div",{style:{background:"#dbeafe",border:"2px solid #3b82f6",color:"#1d4ed8",padding:"12px 20px",borderRadius:"12px",fontSize:"14px",fontWeight:500,minWidth:"180px",textAlign:"center",position:"relative",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[n.length>0&&e.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",display:"flex",gap:"2px",background:"rgba(255, 255, 255, 0.9)",padding:"2px 4px",borderRadius:"4px",fontSize:"12px"},title:`Tools: ${n.map(w=>w.type).join(", ")}`,children:n.map(w=>e.jsx("span",{children:d[w.type]||"🔧"},w.type))}),l&&e.jsx("button",{onClick:o,style:{position:"absolute",top:"4px",right:"4px",background:"rgba(59, 130, 246, 0.15)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"4px",padding:"3px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:w=>{w.currentTarget.style.background="rgba(59, 130, 246, 0.25)",w.currentTarget.style.transform="scale(1.1)"},onMouseLeave:w=>{w.currentTarget.style.background="rgba(59, 130, 246, 0.15)",w.currentTarget.style.transform="scale(1)"},title:"View System Prompt",children:e.jsx(ve,{size:12,color:"#3b82f6"})}),e.jsx(be,{type:"target",position:je.Top,style:{background:"transparent",width:"10px",height:"10px",border:"none",top:"-5px"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx(Ue,{size:16}),e.jsx("span",{children:(s==null?void 0:s.label)||"Agent"})]}),e.jsx("div",{style:{fontSize:"11px",marginTop:"2px",color:r?"#1d4ed8":"#ef4444",opacity:r?.7:1,fontWeight:r?400:500},children:r?t:"No model selected"}),(s==null?void 0:s.memo)&&e.jsxs("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"4px",fontStyle:"italic",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.2"},title:s.memo,children:["📝 ",s.memo]})]}),e.jsx(be,{type:"source",position:je.Bottom,style:{background:"transparent",width:"10px",height:"10px",border:"none",bottom:"-5px"}})]})},jt=s=>e.jsx(ue,{...s,type:"vectorstore"}),vt=s=>e.jsx(ue,{...s,type:"knowledgebase"}),wt=s=>e.jsx(ue,{...s,type:"mcp"}),Nt=s=>e.jsx(ue,{...s,type:"apicall"}),kt=s=>e.jsx(ue,{...s,type:"router"}),Ct=s=>e.jsx(ue,{...s,type:"finaloutput"}),St=s=>e.jsx(ue,{...s,type:"default"}),ks={userinput:yt,agent:bt,vectorstore:jt,knowledgebase:vt,mcp:wt,apicall:Nt,router:kt,finaloutput:Ct,default:St},ds=({id:s,sourceX:a,sourceY:t,targetX:r,targetY:l,style:n={},markerEnd:d,markerStart:o,data:h,source:c,target:j})=>{const g=c===j,N=t>l+20,M=Math.abs(t-l)<50&&!g,z=(h==null?void 0:h.locked)===!0;h==null||h.direction;let w;if(g)w=`M ${a},${t} 
                C ${a+80*1},${t-80} 
                  ${a+80*1},${t+80} 
                  ${a},${t}`;else if(N&&!M){const k=Math.abs(a-r),p=Math.abs(t-l),S=a<=r,_=Math.min(1.5,p/200),$=Math.max(150,Math.min(300,k*_));if(S){const W=Math.max(a,r)+$,y=(t+l)/2;w=`M ${a},${t}
                  C ${a+30},${t}
                    ${W},${t-30}
                    ${W},${y}
                  S ${W},${l+30}
                    ${r+30},${l}
                  L ${r},${l}`}else{const W=Math.min(a,r)-$,y=(t+l)/2;w=`M ${a},${t}
                  C ${a-30},${t}
                    ${W},${t-30}
                    ${W},${y}
                  S ${W},${l+30}
                    ${r-30},${l}
                  L ${r},${l}`}}else if(M){const k=(a+r)/2,p=a<r?60:-60;w=`M ${a},${t}
                Q ${k},${t+p}
                  ${r},${l}`}else{const k=(t+l)/2;w=`M ${a},${t}
                C ${a},${k}
                  ${r},${k}
                  ${r},${l}`}const u=(a+r)/2,C=(t+l)/2,P={...n,stroke:z?"#fb923c":(n==null?void 0:n.stroke)||"#374151",strokeWidth:z?2:(n==null?void 0:n.strokeWidth)||3,strokeDasharray:z?"8 4":"5 5",animation:"dashdraw 0.5s linear infinite"};return e.jsxs("g",{children:[e.jsx("path",{id:s,d:w,fill:"none",style:P,markerEnd:d,markerStart:o}),z&&e.jsx("foreignObject",{x:u-12,y:C-12,width:24,height:24,children:e.jsx("div",{style:{background:"#fff8ed",border:"1px solid #fb923c",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},title:"Locked bidirectional connection",children:"🔒"})}),(h==null?void 0:h.sourceOutput)&&!z&&e.jsx("foreignObject",{x:u-40,y:C-15,width:80,height:30,children:e.jsx("div",{style:{background:"#ffffff",border:"1px solid #374151",borderRadius:"4px",padding:"4px 8px",fontSize:"11px",fontWeight:600,textAlign:"center",cursor:"pointer",userSelect:"none"},onClick:k=>{k.stopPropagation(),h.onLabelClick&&h.onLabelClick(k,s,h.sourceOutput)},children:h.sourceOutput})})]})},Cs={custom:ds,smoothstep:ds},Ss=document.createElement("style");Ss.textContent=`
  @keyframes dashdraw {
    from {
      stroke-dashoffset: 10;
    }
    to {
      stroke-dashoffset: 0;
    }
  }
`;document.head.appendChild(Ss);const $t=({nodes:s,edges:a,onNodeClick:t,onPaneClick:r})=>{const{fitView:l}=As();x.useEffect(()=>{if(s.length>0){const d=setTimeout(()=>{l({padding:.2,includeHiddenNodes:!1,minZoom:.5,maxZoom:1.5})},50);return()=>clearTimeout(d)}},[s,a,l]);const n={animated:!0,type:"custom",markerEnd:{type:zs.ArrowClosed,width:20,height:20,color:"#374151"},style:{strokeWidth:3,stroke:"#374151"}};return e.jsxs(Ws,{nodes:s,edges:a,nodeTypes:ks,edgeTypes:Cs,onNodeClick:t,onPaneClick:r,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!0,defaultEdgeOptions:n,fitView:!0,fitViewOptions:{padding:.2,includeHiddenNodes:!1,minZoom:.5,maxZoom:1.5},className:"bg-gray-50",children:[e.jsx(Ps,{variant:Os.Dots,gap:12,size:1}),e.jsx(_s,{}),e.jsx(Ds,{})]})},Mt=s=>e.jsx(Is,{children:e.jsx("div",{className:"w-full h-full",children:e.jsx($t,{...s})})}),Et=s=>e.jsx(Mt,{nodes:s.nodes,edges:s.edges,onNodeClick:s.onNodeClick,onPaneClick:s.onPaneClick}),ms={userinput:"Captures user input like text or JSON and passes it to the next node.",agent:"Takes input and creates output based on a prompt using AI.",agenttool:"Built-in tools that AI agents can use to extend their capabilities.",vectorstore:"Stores and searches data using similarity matching. Returns related documents.",knowledgebase:"Searches structured data (like databases) using queries to find information.",mcp:"Requests and returns information in a standard format that AI can understand.",apicall:"Calls external APIs (REST/GraphQL) to get data or trigger remote actions.",router:"Decides which path to take based on input values, scores, or rules.",finaloutput:"Collects all results and returns them to the user or another system."},Ze=s=>{switch(s){case"userinput":return e.jsx($e,{className:"w-4 h-4"});case"agent":return e.jsx(Ue,{className:"w-4 h-4"});case"llmchain":return e.jsx(et,{className:"w-4 h-4"});case"llmengine":return e.jsx(at,{className:"w-4 h-4"});case"workflow":return e.jsx(pt,{className:"w-4 h-4"});case"aggregator":return e.jsx(Xs,{className:"w-4 h-4"});case"decision":return e.jsx(rs,{className:"w-4 h-4"});case"function":return e.jsx(tt,{className:"w-4 h-4"});case"datasource":return e.jsx(as,{className:"w-4 h-4"});case"output":return e.jsx(ve,{className:"w-4 h-4"});case"api":return e.jsx(mt,{className:"w-4 h-4"});default:return e.jsx(fs,{className:"w-4 h-4"})}},Ge=s=>{switch(s){case"userinput":return"text-green-600";case"agent":return"text-blue-600";case"llmchain":return"text-purple-600";case"llmengine":return"text-orange-600";case"workflow":return"text-indigo-600";case"aggregator":return"text-pink-600";case"decision":return"text-yellow-600";case"function":return"text-red-600";case"datasource":return"text-cyan-600";case"output":return"text-gray-600";case"api":return"text-teal-600";default:return"text-gray-500"}},Lt=({value:s,onChange:a,nodes:t,placeholder:r="Select a node",className:l=""})=>{var j;const[n,d]=x.useState(!1),o=x.useRef(null),h=t.find(g=>g.id===s);x.useEffect(()=>{const g=N=>{o.current&&!o.current.contains(N.target)&&d(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const c=g=>{a(g),d(!1)};return e.jsxs("div",{className:`relative ${l}`,ref:o,children:[e.jsxs("button",{type:"button",onClick:()=>d(!n),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded bg-white hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-musashi-500 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:Ge(h.type||"default"),children:Ze(h.type||"default")}),e.jsx("span",{children:((j=h.data)==null?void 0:j.label)||"Unnamed"})]}):e.jsx("span",{className:"text-gray-500",children:r})}),e.jsx(ss,{className:`w-4 h-4 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:t.length===0?e.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No nodes available"}):t.map(g=>{var N;return e.jsxs("button",{onClick:()=>c(g.id),className:"w-full px-3 py-2 text-xs hover:bg-gray-100 flex items-center space-x-2 text-left",children:[e.jsx("span",{className:Ge(g.type||"default"),children:Ze(g.type||"default")}),e.jsx("span",{children:((N=g.data)==null?void 0:N.label)||"Unnamed"})]},g.id)})})]})},Tt=({edgeId:s,currentDirection:a,onDirectionChange:t})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>t(s,"unidirectional"),className:`p-2 rounded-md border ${a==="unidirectional"?"bg-musashi-600 text-white border-musashi-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Unidirectional (one-way)",children:e.jsx(Ys,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>t(s,"bidirectional"),className:`p-2 rounded-md border ${a==="bidirectional"?"bg-musashi-600 text-white border-musashi-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Bidirectional (two-way)",children:e.jsx(Qs,{className:"w-4 h-4"})})]}),hs=({output:s,outputHandle:a,selectedNodeId:t,edges:r,nodes:l,availableNodes:n,onAddConnection:d,onRemoveConnection:o,onUpdateEdgeDirection:h})=>{const[c,j]=x.useState(!1),[g,N]=x.useState(""),M=r.filter(u=>u.source===t&&u.sourceHandle===a),z=()=>{g&&(d(t,g,a),N(""),j(!1))},w=()=>{j(!1),N("")};return x.useEffect(()=>{g&&c&&z()},[g]),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s.key}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.type,")"]})]})}),M.length>0&&e.jsx("div",{className:"space-y-1 mb-2",children:M.map(u=>{var k,p;const C=l.find(S=>S.id===u.target),P=(C==null?void 0:C.type)||"default";return e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:Ge(P),children:Ze(P)}),e.jsx("span",{className:"text-xs",children:((k=C==null?void 0:C.data)==null?void 0:k.label)||"Unknown"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[h&&e.jsx(Tt,{edgeId:u.id,currentDirection:((p=u.data)==null?void 0:p.direction)||"unidirectional",onDirectionChange:h}),e.jsx("button",{onClick:()=>o(u.id),className:"text-red-600 hover:text-red-700 p-1",title:"Remove connection",children:e.jsx(Ke,{className:"w-3 h-3"})})]})]},u.id)})}),c?e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx(Lt,{value:g,onChange:N,nodes:n,placeholder:"Select target node to connect"}),e.jsx("button",{onClick:w,className:"w-full px-2 py-1 text-xs text-gray-600 hover:text-gray-800",children:"Cancel"})]}):e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center text-xs text-musashi-600 hover:text-musashi-700",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add connection from ",s.key]})]})},He=[{value:"O3",label:"O3",provider:"OpenAI"},{value:"O3-mini",label:"O3 Mini",provider:"OpenAI"},{value:"O3-pro",label:"O3 Pro",provider:"OpenAI"},{value:"O4-mini",label:"O4 Mini",provider:"OpenAI"},{value:"Gpt-4.1",label:"GPT-4.1",provider:"OpenAI"},{value:"Gpt-4o",label:"GPT-4o",provider:"OpenAI"},{value:"Claude Opus 4.1",label:"Claude Opus 4.1",provider:"Anthropic"},{value:"Claude Sonnet 4",label:"Claude Sonnet 4",provider:"Anthropic"},{value:"Claude Haiku 3.5",label:"Claude Haiku 3.5",provider:"Anthropic"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash",provider:"Google"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro",provider:"Google"}];He.reduce((s,a)=>(s[a.provider]||(s[a.provider]=[]),s[a.provider].push(a),s),{});const It=({value:s,onChange:a,placeholder:t="e.g., gpt-4, claude-3",required:r=!1})=>{const[l,n]=x.useState(!1),[d,o]=x.useState(s||""),[h,c]=x.useState(He),j=x.useRef(null),g=x.useRef(null);x.useEffect(()=>{o(s||"")},[s]),x.useEffect(()=>{const u=d.toLowerCase();c(u?He.filter(C=>C.value.toLowerCase().includes(u)||C.label.toLowerCase().includes(u)||C.provider.toLowerCase().includes(u)):He)},[d]),x.useEffect(()=>{const u=C=>{j.current&&!j.current.contains(C.target)&&(n(!1),d!==s&&a(d))};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[d,s,a]);const N=u=>{const C=u.target.value;o(C),n(!0)},M=()=>{setTimeout(()=>{d!==s&&a(d)},200)},z=u=>{var C;o(u),a(u),n(!1),(C=g.current)==null||C.blur()},w=h.reduce((u,C)=>(u[C.provider]||(u[C.provider]=[]),u[C.provider].push(C),u),{});return e.jsxs("div",{ref:j,className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:g,type:"text",value:d,onChange:N,onFocus:()=>n(!0),onBlur:M,className:"w-full px-3 py-2 pr-8 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500",placeholder:t,required:r}),e.jsx("button",{type:"button",onClick:()=>{var u;n(!l),(u=g.current)==null||u.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(ss,{className:`w-4 h-4 transition-transform ${l?"rotate-180":""}`})})]}),l&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:Object.keys(w).length===0?e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No models found. You can still type a custom model name."}):Object.entries(w).map(([u,C])=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-1 text-xs font-medium text-gray-500 bg-gray-50 sticky top-0",children:u}),C.map(P=>e.jsxs("button",{type:"button",onClick:()=>z(P.value),className:"w-full px-3 py-2 text-sm text-left hover:bg-gray-100 focus:bg-gray-100 focus:outline-none",children:[e.jsx("div",{className:"font-medium",children:P.value}),e.jsx("div",{className:"text-xs text-gray-500",children:P.label})]},P.value))]},u))})]})};function At(s){const a=/\$\$([A-Za-z_][A-Za-z0-9_]*)\$\$/g,t=[];let r;for(;(r=a.exec(s))!==null;)t.push(r[1]);return[...new Set(t)]}function Je(s,a){const t={isValid:!0,warnings:[],unusedInputs:[],invalidTokens:[]};if(!s||!a||a.length===0)return t;const r=At(s),l=a.map(o=>o.key),n=r.filter(o=>!l.includes(o));n.length>0&&(t.isValid=!1,t.invalidTokens=n,t.warnings.push(`Unknown tokens: ${n.map(o=>`$$${o}$$`).join(", ")}`));const d=l.filter(o=>!r.includes(o));return d.length>0&&(t.isValid=!1,t.unusedInputs=d,t.warnings.push(`Unused inputs: ${d.join(", ")}`)),t}function $s(s){const a=[];return s.invalidTokens.length>0&&a.push(`Unknown tokens: ${s.invalidTokens.map(t=>`$$${t}$$`).join(", ")}`),s.unusedInputs.length>0&&a.push(`Unused inputs: ${s.unusedInputs.join(", ")}`),a.join(" • ")}const zt=({isOpen:s,onClose:a,value:t,onChange:r,inputs:l})=>{const[n,d]=x.useState(t),[o,h]=x.useState(()=>Je(t,l)),[c,j]=x.useState(!1),[g,N]=x.useState(!1),[M,z]=x.useState(!0);if(x.useEffect(()=>{d(t)},[t]),x.useEffect(()=>{h(Je(n,l))},[n,l]),x.useEffect(()=>{const p=S=>{S.key==="Escape"&&c&&(S.preventDefault(),j(!1))};if(s)return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[s,c]),!s)return null;const w=()=>{r(n),a()},u=()=>{d(t),j(!1),a()},C=async()=>{try{await navigator.clipboard.writeText(n),N(!0),setTimeout(()=>N(!1),2e3)}catch(p){console.error("Failed to copy:",p)}},P=p=>{const S=$=>$.split(/(\$\$[A-Za-z_][A-Za-z0-9_]*\$\$)/g).map((y,Z)=>{if(y.match(/^\$\$[A-Za-z_][A-Za-z0-9_]*\$\$/)){const Y=y.slice(2,-2),se=l.some(ee=>ee.key===Y);return e.jsx("span",{className:`font-mono px-1 py-0.5 rounded ${se?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y},Z)}return y});return p.split(`
`).map(($,W)=>{if($.startsWith("### "))return e.jsx("h3",{className:"text-base font-semibold mt-3 mb-2",children:S($.substring(4))},W);if($.startsWith("## "))return e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:S($.substring(3))},W);if($.startsWith("# "))return e.jsx("h1",{className:"text-xl font-bold mt-4 mb-3",children:S($.substring(2))},W);if($.startsWith("```"))return e.jsx("div",{className:"font-mono text-sm bg-gray-100 p-1 rounded",children:$},W);if($.startsWith("- ")||$.startsWith("* "))return e.jsx("li",{className:"ml-4 mt-1 list-disc",children:S($.substring(2))},W);if($.match(/^\d+\. /))return e.jsx("li",{className:"ml-4 mt-1 list-decimal",children:S($.replace(/^\d+\. /,""))},W);const y=/\*\*(.+?)\*\*/g,Z=/\*(.+?)\*/g,Y=/`(.+?)`/g;if(y.test($)||Z.test($)||Y.test($)){const B=$.replace(Y,(R,q)=>`<CODE>${q}</CODE>`).replace(y,(R,q)=>`<BOLD>${q}</BOLD>`).replace(Z,(R,q)=>`<ITALIC>${q}</ITALIC>`).split(/(<CODE>.*?<\/CODE>|<BOLD>.*?<\/BOLD>|<ITALIC>.*?<\/ITALIC>)/g);return e.jsx("p",{className:"mt-1",children:B.map((R,q)=>R.startsWith("<CODE>")&&R.endsWith("</CODE>")?e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded font-mono text-sm",children:R.slice(6,-7)},q):R.startsWith("<BOLD>")&&R.endsWith("</BOLD>")?e.jsx("strong",{children:S(R.slice(6,-7))},q):R.startsWith("<ITALIC>")&&R.endsWith("</ITALIC>")?e.jsx("em",{children:S(R.slice(8,-9))},q):S(R))},W)}return $.trim()?e.jsx("p",{className:"mt-1",children:S($)},W):e.jsx("br",{},W)})},k=p=>typeof p=="string"?p.split(/(\$\$[A-Za-z_][A-Za-z0-9_]*\$\$)/g).map((_,$)=>{if(_.match(/^\$\$[A-Za-z_][A-Za-z0-9_]*\$\$/)){const W=_.slice(2,-2),y=l.some(Z=>Z.key===W);return e.jsx("span",{className:`font-mono px-1 py-0.5 rounded ${y?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_},$)}return _}):p;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:u}),e.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl flex flex-col transition-all duration-300 ${c?"w-full h-full m-0":"w-full max-w-6xl h-[80vh] mx-4"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Edit System Prompt"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configure AI agent behavior"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Copy to clipboard",children:g?e.jsx(es,{className:"w-4 h-4 text-green-600"}):e.jsx(ts,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:()=>j(!c),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:c?"Exit fullscreen":"Fullscreen",children:c?e.jsx(vs,{className:"w-4 h-4 text-gray-600"}):e.jsx(js,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors ml-2",children:e.jsx(Ne,{className:"w-4 h-4 text-gray-600"})})]})]}),!o.isValid&&e.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-b border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Se,{className:"w-4 h-4 text-yellow-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-yellow-800",children:$s(o)})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-r",children:[e.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b",children:e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Editor"})}),e.jsx("textarea",{value:n,onChange:p=>d(p.target.value),className:"flex-1 p-4 font-mono text-sm resize-none focus:outline-none",placeholder:`Enter your system prompt here. Use $$input_key$$ to reference inputs.

Example:
# Task Instructions

Process the $$input$$ data and generate a summary.

## Requirements
- Be concise
- Focus on key points
- Use markdown formatting`})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"px-4 py-2 bg-gray-50 border-b flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Preview"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>z(!1),className:`px-2 py-1 text-xs rounded transition-colors ${M?"bg-white text-gray-600 hover:bg-gray-100":"bg-gray-200 text-gray-800"}`,children:"Raw"}),e.jsx("button",{onClick:()=>z(!0),className:`px-2 py-1 text-xs rounded transition-colors ${M?"bg-gray-200 text-gray-800":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Markdown"})]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:M?e.jsx("div",{className:"prose prose-sm max-w-none",children:n?P(n):e.jsx("em",{className:"text-gray-400",children:"No content to preview"})}):e.jsx("div",{className:"whitespace-pre-wrap font-mono text-sm",children:n?k(n):e.jsx("em",{className:"text-gray-400",children:"No content to preview"})})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[n.split(/\s+/).filter(p=>p.length>0).length," words · ",n.length," characters"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Inputs: ",l.length>0?l.map(p=>`$$${p.key}$$`).join(", "):"none"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:w,className:"px-4 py-2 text-sm bg-musashi-600 text-white rounded-md hover:bg-musashi-700",children:"Save"})]})]})]})]})};function Ms(s,a){var n;const t={isValid:!0,warnings:[],unconnectedInputs:[]};if(s.type!=="agent")return t;const r=((n=s.data)==null?void 0:n.connected_inputs)||[],l=a.filter(d=>d.target===s.id);return l.forEach(d=>{var c;const o=((c=d.sourceHandle)==null?void 0:c.replace("output-",""))||"output";r.some(j=>j.nodeId===d.source&&j.outputKey===o)||(t.isValid=!1,t.warnings.push(`Edge from node ${d.source} is not registered in connected_inputs`))}),r.forEach(d=>{l.some(h=>h.source===d.nodeId&&h.sourceHandle===`output-${d.outputKey}`)||(t.isValid=!1,t.warnings.push(`Connected input "${d.outputKey}" from "${d.nodeName}" has no actual edge`),t.unconnectedInputs.push(d.outputKey))}),t}function Wt(s,a,t){const r={isValid:!0,warnings:[],unconnectedInputs:[]};return s.type!=="userinput"||t.filter(d=>d.source===s.id).map(d=>a.find(o=>o.id===d.target)).filter(d=>d&&d.type==="agent").forEach(d=>{const o=Ms(d,t);o.isValid||(r.isValid=!1,r.warnings.push(...o.warnings),r.unconnectedInputs.push(...o.unconnectedInputs))}),r}const Pt=({output:s,index:a,onUpdate:t,onDelete:r})=>{const[l,n]=x.useState(!1),[d,o]=x.useState(s.key),[h,c]=x.useState(s.type),[j,g]=x.useState(s.example||""),N=()=>{d.trim()&&(t({key:d.trim(),type:h,example:j.trim()}),n(!1))},M=()=>{o(s.key),c(s.type),g(s.example||""),n(!1)},z=u=>{try{const C=JSON.parse(u);return JSON.stringify(C,null,2).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,k=>{let p="number";return/^"/.test(k)?/:$/.test(k)?p="key":p="string":/true|false/.test(k)?p="boolean":/null/.test(k)&&(p="null"),`<span style="color: ${{key:"#0550ae",string:"#0a7ea4",number:"#0550ae",boolean:"#0550ae",null:"#6e7781"}[p]}">${k}</span>`})}catch{return u}},w=u=>{if(!u)return!1;try{return typeof JSON.parse(u)=="object"}catch{return!1}};return l?e.jsxs("div",{className:"bg-gray-50 p-2 rounded-md space-y-2",children:[e.jsx("input",{type:"text",value:d,onChange:u=>o(u.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-musashi-500",placeholder:"Key name"}),e.jsxs("select",{value:h,onChange:u=>c(u.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-musashi-500",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"object",children:"Object"}),e.jsx("option",{value:"array",children:"Array"})]}),e.jsx("textarea",{value:j,onChange:u=>g(u.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-musashi-500 font-mono",placeholder:h==="object"?'{"key": "value"}':h==="array"?'["item1", "item2"]':"Example value",rows:3}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:N,disabled:!d.trim(),className:`flex-1 px-2 py-1 text-xs rounded ${d.trim()?"bg-musashi-600 text-white hover:bg-musashi-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Save"}),e.jsx("button",{onClick:M,className:"flex-1 px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"})]})]}):e.jsxs("div",{className:"bg-gray-50 p-2 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:s.key}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",s.type,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>n(!0),className:"text-gray-600 hover:text-gray-700 p-1",title:"Edit output",children:e.jsx(ws,{className:"w-3 h-3"})}),e.jsx("button",{onClick:r,className:"text-red-600 hover:text-red-700 p-1",title:"Delete output",children:e.jsx(ls,{className:"w-3 h-3"})})]})]}),s.example&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Example:"}),w(s.example)?e.jsx("pre",{className:"mt-1 p-2 bg-gray-100 rounded text-xs overflow-x-auto font-mono",dangerouslySetInnerHTML:{__html:z(s.example)}}):e.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-xs font-mono text-gray-700",children:s.example})]})]})},Ot=({selectedNode:s,nodes:a,edges:t,onClose:r,onUpdateNode:l,onDeleteNode:n,onAddConnection:d,onRemoveConnection:o,onUpdateEdgeDirection:h})=>{var R,q,le,te,pe,ce,Me,Ee,Le,Te,Ie,Ae,ze,We,Pe,Oe;const[c,j]=x.useState(!1),[g,N]=x.useState(""),[M,z]=x.useState(!1),[w,u]=x.useState(""),[C,P]=x.useState("string"),[k,p]=x.useState(""),[S,_]=x.useState(!1),[$,W]=x.useState(!1);if(!s)return null;const y=a.find(v=>v.id===s.id)||s,Z=t.filter(v=>v.source===s.id),Y=t.filter(v=>v.target===s.id),se=a.filter(v=>v.id!==s.id),ee=v=>{const D=v.target.value;l(s.id,{data:{...s.data,label:D}})},E=()=>{g&&(d(s.id,g),N(""),j(!1))},B=()=>{n(s.id),r()};return e.jsxs("div",{className:"absolute right-0 top-0 h-full w-80 bg-white shadow-lg border-l border-gray-200 z-10 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Node Details"}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(Ne,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.type&&ms[s.type]&&e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:ms[s.type]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:((R=y.data)==null?void 0:R.name)||"Unnamed"})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("span",{className:"text-xs text-gray-600 font-mono select-all",children:s.id})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:((q=y.data)==null?void 0:q.label)||"",onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Memo"}),e.jsx("textarea",{value:((le=y.data)==null?void 0:le.memo)||"",onChange:v=>{l(s.id,{data:{...s.data,memo:v.target.value}})},placeholder:"Add your notes or comments here...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500 resize-none",rows:3})]}),s.type==="agent"&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(is,{className:"w-4 h-4 mr-1"}),"Connected Inputs"]}),e.jsx("div",{className:"space-y-2",children:(te=y.data)!=null&&te.connected_inputs&&y.data.connected_inputs.length>0?y.data.connected_inputs.map((v,D)=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["$$",v.outputKey,"$$"]}),e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded",children:v.outputType})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["From: ",e.jsx("span",{className:"font-medium",children:v.nodeName}),v.outputExample&&e.jsxs("div",{className:"mt-1",children:["Example: ",e.jsx("span",{className:"italic",children:v.outputExample})]})]})]}),e.jsx("button",{onClick:()=>{const K=t.find(f=>f.target===s.id&&f.source===v.nodeId&&f.sourceHandle===`output-${v.outputKey}`);K&&o(K.id)},className:"p-1 hover:bg-gray-200 rounded transition-colors ml-2",title:"Remove connection",children:e.jsx(Ne,{className:"w-4 h-4 text-gray-500"})})]})},D)):e.jsx("div",{className:"text-sm text-gray-500 italic p-3 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inputs connected. Connect outputs from other nodes to provide inputs to this Agent."})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Outputs"}),e.jsxs("div",{className:"space-y-2",children:[(((pe=y.data)==null?void 0:pe.outputs)||[]).map((v,D)=>e.jsx(Pt,{output:v,index:D,onUpdate:K=>{var b;const f=[...((b=y.data)==null?void 0:b.outputs)||[]];f[D]=K,l(s.id,{data:{...y.data,outputs:f}})},onDelete:()=>{var f;const K=[...((f=y.data)==null?void 0:f.outputs)||[]];K.splice(D,1),l(s.id,{data:{...y.data,outputs:K}})}},D)),(!((ce=y.data)!=null&&ce.outputs)||y.data.outputs.length<30)&&!M&&e.jsxs("button",{onClick:()=>{var v;z(!0),u(`output${(((v=y.data)==null?void 0:v.outputs)||[]).length+1}`),P("string"),p("")},className:"flex items-center text-sm text-musashi-600 hover:text-musashi-700 w-full justify-center py-2 border border-dashed border-gray-300 rounded-md hover:border-musashi-300",children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Add Output"]}),M&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Key name",value:w,onChange:v=>u(v.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-musashi-500"}),e.jsxs("select",{value:C,onChange:v=>P(v.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-musashi-500",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"object",children:"Object"}),e.jsx("option",{value:"array",children:"Array"})]}),e.jsx("textarea",{value:k,onChange:v=>p(v.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-musashi-500 font-mono",placeholder:C==="object"?'{"key": "value"}':C==="array"?'["item1", "item2"]':"Example value",rows:3}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{var v;if(w.trim()){const D=[...((v=y.data)==null?void 0:v.outputs)||[]];D.push({key:w.trim(),type:C,example:k.trim()}),l(s.id,{data:{...y.data,outputs:D}}),z(!1),u(""),P("string"),p("")}},disabled:!w.trim(),className:`flex-1 px-2 py-1 text-xs rounded ${w.trim()?"bg-musashi-600 text-white hover:bg-musashi-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Add"}),e.jsx("button",{onClick:()=>{z(!1),u(""),P("string"),p("")},className:"flex-1 px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"})]})]}),((Me=y.data)==null?void 0:Me.outputs)&&y.data.outputs.length>=30&&e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Maximum 30 outputs reached"})]})]}),s.type==="agent"&&((Ee=y.data)==null?void 0:Ee.parameters)&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Parameters"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Model ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(It,{value:y.data.parameters.model||"",onChange:v=>{l(s.id,{data:{...y.data,parameters:{...y.data.parameters,model:v}}})},required:!0}),!y.data.parameters.model&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Model is required"})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("button",{onClick:()=>_(!S),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors",children:[S?e.jsx(st,{className:"w-4 h-4 mr-1"}):e.jsx(ss,{className:"w-4 h-4 mr-1"}),"Advanced Options"]}),S&&e.jsxs("div",{className:"mt-3 space-y-3 pl-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Temperature: ",y.data.parameters.temperature||1]}),e.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:y.data.parameters.temperature||1,onChange:v=>{l(s.id,{data:{...y.data,parameters:{...y.data.parameters,temperature:parseFloat(v.target.value)}}})},className:"w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Controls randomness in the output"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Max Tokens"}),e.jsx("input",{type:"number",value:y.data.parameters.max_tokens||1e4,onChange:v=>{l(s.id,{data:{...y.data,parameters:{...y.data.parameters,max_tokens:parseInt(v.target.value)||1e4}}})},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500",min:"1",max:"128000"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum number of tokens to generate"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Top P: ",y.data.parameters.top_p||1]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:y.data.parameters.top_p||1,onChange:v=>{l(s.id,{data:{...y.data,parameters:{...y.data.parameters,top_p:parseFloat(v.target.value)}}})},className:"w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nucleus sampling parameter"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Agent Tools"}),e.jsx("div",{className:"space-y-2 bg-gray-50 p-3 rounded-md",children:[{type:"web_search",label:"Web Search",icon:"🌐"},{type:"api_call",label:"API Call",icon:"🔌"},{type:"file_search",label:"File Search",icon:"📁"},{type:"code_interpreter",label:"Code Interpreter",icon:"💻"},{type:"image_generation",label:"Image Generation",icon:"🎨"}].map(v=>{var K;const D=((K=y.data.parameters.tools)==null?void 0:K.some(f=>f.type===v.type&&f.enabled))||!1;return e.jsxs("label",{className:"flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:D,onChange:f=>{const b=y.data.parameters.tools||[];let I;f.target.checked?b.find(A=>A.type===v.type)?I=b.map(A=>A.type===v.type?{...A,enabled:!0}:A):I=[...b,{type:v.type,enabled:!0}]:I=b.map(L=>L.type===v.type?{...L,enabled:!1}:L),l(s.id,{data:{...y.data,parameters:{...y.data.parameters,tools:I}}})},className:"mr-2"}),e.jsx("span",{className:"text-lg mr-2",children:v.icon}),e.jsx("span",{className:"text-sm",children:v.label})]},v.type)})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select built-in tools this agent can use"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700",children:["System Prompt ",e.jsx("span",{className:"text-red-500",children:"*"})]}),(()=>{var D;const v=Je(y.data.parameters.system_prompt||"",((D=y.data)==null?void 0:D.inputs)||[]);return v.isValid?null:e.jsxs("div",{className:"flex items-center text-yellow-600",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"text-xs",children:$s(v)})]})})()]}),e.jsx("div",{className:"bg-gray-50 border border-gray-300 rounded-md p-3 mb-2",children:y.data.parameters.system_prompt?e.jsx("div",{className:"text-sm text-gray-700 font-mono whitespace-pre-wrap break-words max-h-32 overflow-y-auto",children:y.data.parameters.system_prompt.length>200?y.data.parameters.system_prompt.substring(0,200)+"...":y.data.parameters.system_prompt}):e.jsx("div",{className:"text-sm text-gray-500 italic",children:"No system prompt defined. Click edit to add one."})}),e.jsxs("button",{onClick:()=>W(!0),className:"w-full px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 flex items-center justify-center",children:[e.jsx(ws,{className:"w-4 h-4 mr-2"}),"Edit System Prompt"]}),e.jsxs("div",{className:"flex items-start justify-between mt-1",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[((Le=y.data.parameters.system_prompt)==null?void 0:Le.length)||0," characters"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Available inputs: ",(((Te=y.data)==null?void 0:Te.connected_inputs)||[]).map(v=>`$$${v.outputKey}$$`).join(", ")||"none"]})]}),!y.data.parameters.system_prompt&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"System prompt is required"})]})]})]}),s.type==="agent"&&(()=>{const v=Ms(y,t);return v.isValid?null:e.jsx("div",{className:"border-t pt-4",children:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Se,{className:"w-4 h-4 text-yellow-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Connection Required"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"All Agent inputs must be connected. The following inputs are not connected:"}),e.jsx("ul",{className:"text-xs text-yellow-700 mt-2 list-disc list-inside",children:v.unconnectedInputs.map((D,K)=>e.jsx("li",{children:D},K))})]})]})})})})(),s.type==="userinput"&&(()=>{const v=Wt(y,a,t);return v.isValid?null:e.jsx("div",{className:"border-t pt-4",children:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Se,{className:"w-4 h-4 text-yellow-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Connected Agent Warning"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Some connected Agent nodes have unconnected inputs:"}),e.jsx("ul",{className:"text-xs text-yellow-700 mt-2 list-disc list-inside",children:v.warnings.map((D,K)=>e.jsx("li",{children:D},K))})]})]})})})})(),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Connections"}),s.type==="userinput"?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Connect outputs to other nodes:"}),(Ie=y.data)!=null&&Ie.outputs&&y.data.outputs.length>0?y.data.outputs.map(v=>e.jsx(hs,{output:v,outputHandle:`output-${v.key}`,selectedNodeId:s.id,edges:t,nodes:a,availableNodes:se,onAddConnection:d,onRemoveConnection:o,onUpdateEdgeDirection:h},v.key)):e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:e.jsxs("p",{className:"text-xs text-yellow-700",children:[e.jsx("span",{className:"font-semibold",children:"No outputs defined."})," User Input nodes require at least one output to create connections. Please add an output above."]})})]}):s.type==="agent"?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Connect outputs to other nodes:"}),(Ae=y.data)!=null&&Ae.outputs&&y.data.outputs.length>0?y.data.outputs.map(v=>e.jsx(hs,{output:v,outputHandle:`output-${v.key}`,selectedNodeId:s.id,edges:t,nodes:a,availableNodes:se,onAddConnection:d,onRemoveConnection:o,onUpdateEdgeDirection:h},v.key)):e.jsx("p",{className:"text-xs text-gray-500 italic",children:"No outputs defined. Add outputs above if you want to connect this Agent to other nodes."})]}):e.jsxs(e.Fragment,{children:[Y.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Incoming from:"}),Y.map(v=>{var K;const D=a.find(f=>f.id===v.source);return e.jsx("div",{className:"bg-gray-50 p-2 rounded mb-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:((K=D==null?void 0:D.data)==null?void 0:K.label)||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 font-mono block",children:v.source})]}),e.jsx("button",{onClick:()=>o(v.id),className:"text-red-600 hover:text-red-700 p-1",title:"Remove connection",children:e.jsx(Ke,{className:"w-3 h-3"})})]})},v.id)})]}),Z.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Outgoing to:"}),Z.map(v=>{var K;const D=a.find(f=>f.id===v.target);return e.jsx("div",{className:"bg-gray-50 p-2 rounded mb-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:((K=D==null?void 0:D.data)==null?void 0:K.label)||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-500 font-mono block",children:v.target})]}),e.jsx("button",{onClick:()=>o(v.id),className:"text-red-600 hover:text-red-700 p-1",title:"Remove connection",children:e.jsx(Ke,{className:"w-3 h-3"})})]})},v.id)})]}),!c&&e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center text-sm text-musashi-600 hover:text-musashi-700",children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Add Connection"]})]}),c&&s.type!=="userinput"&&s.type!=="agent"&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("select",{value:g,onChange:v=>N(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500",children:[e.jsx("option",{value:"",children:"Select target node"}),se.map(v=>{var D;return e.jsxs("option",{value:v.id,children:[((D=v.data)==null?void 0:D.label)||"Unnamed"," (",v.id,")"]},v.id)})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:E,disabled:!g,className:`flex-1 px-3 py-1 text-sm rounded ${g?"bg-musashi-600 text-white hover:bg-musashi-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(is,{className:"w-4 h-4 inline mr-1"}),"Connect"]}),e.jsx("button",{onClick:()=>{j(!1),N("")},className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"})]})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("button",{onClick:B,className:"w-full px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center justify-center",children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"Delete Node"]})})]}),(s==null?void 0:s.type)==="agent"&&e.jsx(zt,{isOpen:$,onClose:()=>W(!1),value:((We=(ze=y.data)==null?void 0:ze.parameters)==null?void 0:We.system_prompt)||"",onChange:v=>{l(s.id,{data:{...y.data,parameters:{...y.data.parameters,system_prompt:v}}})},inputs:((Oe=(Pe=y.data)==null?void 0:Pe.connected_inputs)==null?void 0:Oe.map(v=>({key:v.outputKey,type:v.outputType,example:v.outputExample})))||[]})]})},_t=[{type:"userinput",label:"User Input",icon:$e,color:"text-green-600"},{type:"agent",label:"Agent",icon:Ue,color:"text-blue-600"},{type:"vectorstore",label:"Vector Store",icon:as,color:"text-purple-600"},{type:"knowledgebase",label:"Knowledge Base",icon:gs,color:"text-indigo-600"},{type:"mcp",label:"MCP",icon:ot,color:"text-pink-600"},{type:"apicall",label:"API Call",icon:bs,color:"text-teal-600"},{type:"router",label:"Router",icon:rs,color:"text-yellow-600"},{type:"finaloutput",label:"Final Output",icon:ys,color:"text-gray-700"}],Dt=({onAddNode:s})=>{const[a,t]=Ye.useState(!1),r=(l,n)=>{s(l,n),t(!1)};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>t(!a),className:"px-4 py-2 bg-musashi-600 text-white rounded-md hover:bg-musashi-700 flex items-center",children:[e.jsx(we,{className:"w-5 h-5 mr-2"}),"Add Node"]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>t(!1)}),e.jsx("div",{className:"absolute top-12 left-0 bg-white shadow-lg rounded-md border border-gray-200 p-2 z-20 min-w-[200px]",children:_t.map(({type:l,label:n,icon:d,color:o})=>e.jsxs("button",{onClick:()=>r(l,n),className:"w-full px-3 py-2 text-left hover:bg-gray-50 rounded flex items-center space-x-2",children:[e.jsx(d,{className:`w-5 h-5 ${o}`}),e.jsx("span",{children:n})]},l))})]})]})},Bt=({outputKey:s,outputType:a,outputExample:t,position:r,onClose:l})=>{const n=x.useRef(null);x.useEffect(()=>{const o=c=>{n.current&&!n.current.contains(c.target)&&l()},h=setTimeout(()=>{document.addEventListener("mousedown",o)},100);return()=>{clearTimeout(h),document.removeEventListener("mousedown",o)}},[l]);const d={x:r.x-120,y:r.y-150};return e.jsxs("div",{ref:n,className:"absolute z-50 bg-white rounded-lg shadow-xl border border-gray-200 p-4 min-w-[240px] max-w-[320px]",style:{left:`${d.x}px`,top:`${d.y}px`,transform:"translateZ(0)"},children:[e.jsx("div",{className:"absolute bottom-[-8px] left-1/2 transform -translate-x-1/2 w-0 h-0",style:{borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"8px solid white",filter:"drop-shadow(0 2px 2px rgba(0, 0, 0, 0.1))"}}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Output Details"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ne,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Name"}),e.jsx("div",{className:"text-sm font-medium text-gray-800",children:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Type"}),e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-blue-50 text-blue-700 text-xs font-medium",children:a})})]}),t&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Example"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md",children:e.jsx("code",{className:"text-xs text-gray-700 break-all",children:t})})]}),!t&&e.jsx("div",{className:"text-xs text-gray-400 italic",children:"No example provided"})]})]})},i={palette:{gray:{50:"#fefefe",100:"#fcfbfb",200:"#f6f5f4",300:"#dfdcd9",400:"#a39e98",500:"#78736f",600:"#615d59",700:"#494744",800:"#31302e",900:"#191918"},red:{100:"#fef3f1",200:"#fdd3cd",300:"#fbb0a6",400:"#f77463",500:"#f64932",600:"#e32d14",700:"#b01601",800:"#6f0d00",900:"#4f0900"},orange:{100:"#fff5ed",200:"#ffdec4",300:"#ffc599",400:"#ff8a33",500:"#ff6d00",600:"#dd5b00",700:"#ab4a00",800:"#793400",900:"#532200"},yellow:{100:"#fff5e0",200:"#ffe4af",300:"#ffd786",400:"#ffc95e",500:"#ffb110",600:"#e89d01",700:"#c78600",800:"#a16c00",900:"#704b00"},teal:{100:"#f2fafa",200:"#bde6e4",300:"#83cbc9",400:"#2a9d99",500:"#27918d",600:"#0a7b77",700:"#126764",800:"#0a4d4b",900:"#042b29"},blue:{50:"#f8fcff",100:"#f2f9ff",200:"#e6f1fa",300:"#a3d0f7",400:"#62aef0",500:"#097fe8",600:"#0075de",700:"#005bab",800:"#00396b",900:"#002a4f"},purple:{50:"#fcfaff",100:"#f8f5fc",200:"#eadbfa",300:"#d6b6f6",400:"#ad6ded",500:"#9849e8",600:"#7237ae",700:"#562983",800:"#391c57",900:"#1c0e2c"},green:{100:"#f0faf2",200:"#d0f4d8",300:"#abe5b8",400:"#68ce7e",500:"#1aae39",600:"#14832b",700:"#0f6220",800:"#0a4216",900:"#05210b"},pink:{100:"#fff5fc",200:"#ffcdf1",300:"#ffb5eb",400:"#ff83dd",500:"#ff64c8",600:"#d13f9d",700:"#9d2472",800:"#6c1b4f",900:"#481034"},brown:{100:"#fcf8f5",200:"#ebd5c5",300:"#d9b79f",400:"#b18164",500:"#9c7054",600:"#885d3d",700:"#744d2d",800:"#654124",900:"#523410"},black:"#000000",white:"#ffffff",alphaBlack:{100:"#0000000d",200:"#0000001a",300:"#0000004d",400:"#0000004d",500:"#0000008a",600:"#00000096",700:"#000000bf",800:"#000000e6",900:"#000000f2"},alphaWhite:{100:"#ffffff0d",200:"#ffffff1a",300:"#fff3",400:"#ffffff4d",500:"#ffffff80",600:"#ffffffa8",700:"#ffffffbf",800:"#ffffffd9",900:"#fffffff2"},transparent:"#fff0"},theme:{colorPrimary:"#097fe8",colorSecondary:"#000000",colorPage:"#ffffff",colorText:"#191918",colorTextDark:"#191918",colorTextLight:"#0000008a",colorTextMedium:"#00000096",colorBorder:"#0000001a",colorLink:"#0075de",colorLinkHover:"#005bab"},button:{primary:{background:"#0075de",hover:"#005bab",active:"#005bab",text:"#ffffff",border:"#fff0"},secondary:{background:"#f2f9ff",hover:"#e6f1fa",active:"#e6f1fa",text:"#005bab",border:"#fff0"},tertiary:{background:"#ffffff",hover:"#f6f5f4",active:"#f6f5f4",text:"#191918",border:"#0000001a"}},typography:{fontFamilies:{sans:"NotionInter, Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, 'Apple Color Emoji', Arial, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'",serif:"Lyon Text, Georgia, YuMincho, 'Yu Mincho', 'Hiragino Mincho ProN', 'Hiragino Mincho Pro', 'Songti TC', 'Songti SC', SimSun, 'Nanum Myeongjo', NanumMyeongjo, Batang, serif",mono:"iA Writer Mono, Nitti, Menlo, Courier, monospace",handwriting:"Permanent Marker, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, 'Apple Color Emoji', Arial, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'"},fontSizes:{50:"0.75rem",100:"0.875rem",150:"0.9375rem",200:"1rem",300:"1.125rem",350:"1.25rem",400:"1.375rem",500:"1.625rem",600:"2rem",700:"2.625rem",800:"3.375rem",900:"4rem",1e3:"4.75rem"},fontWeights:{regular:400,medium:500,semibold:600,bold:700},lineHeights:{50:"1rem",100:"1.25rem",150:"1.25rem",200:"1.5rem",300:"1.5rem",350:"1.75rem",400:"1.75rem",500:"2rem",600:"2.5rem",700:"3rem",800:"3.5rem",900:"4rem",1e3:"5rem"}},spacing:{4:"0.25rem",8:"0.5rem",12:"0.75rem",16:"1rem",20:"1.25rem",24:"1.5rem",28:"1.75rem",32:"2rem",40:"2.5rem",48:"3rem",56:"3.5rem",64:"4rem",80:"5rem",96:"6rem",128:"8rem",160:"10rem",blockS:"20px",blockM:"24px",blockL:"32px"},borderRadius:{200:"0.25rem",300:"0.3125rem",400:"0.375rem",500:"0.5rem",600:"0.625rem",700:"0.75rem",round:"624.9375rem"}},U=({variant:s="primary",size:a="medium",loading:t=!1,disabled:r,className:l="",children:n,...d})=>{const o=i.button[s],c=`
    inline-flex items-center justify-center
    font-medium rounded-lg
    transition-all duration-200 ease-in-out
    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500
    disabled:opacity-50 disabled:cursor-not-allowed
    ${{small:"px-3 py-1.5 text-sm",medium:"px-4 py-2 text-base",large:"px-6 py-3 text-lg"}[a]}
    ${l}
  `.trim(),j={backgroundColor:o.background,color:o.text,border:o.border!=="#fff0"?`1px solid ${o.border}`:"none"},g={backgroundColor:o.hover};return e.jsxs("button",{className:c,style:j,disabled:r||t,onMouseEnter:N=>{!r&&!t&&Object.assign(N.currentTarget.style,g)},onMouseLeave:N=>{!r&&!t&&Object.assign(N.currentTarget.style,j)},...d,children:[t&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})},m=({variant:s="body",color:a="dark",weight:t,fontFamily:r="sans",className:l="",children:n,as:d,style:o,...h})=>{const c={h1:{fontSize:i.typography.fontSizes[800],lineHeight:i.typography.lineHeights[800],fontWeight:i.typography.fontWeights.bold,element:"h1"},h2:{fontSize:i.typography.fontSizes[600],lineHeight:i.typography.lineHeights[600],fontWeight:i.typography.fontWeights.semibold,element:"h2"},h3:{fontSize:i.typography.fontSizes[500],lineHeight:i.typography.lineHeights[500],fontWeight:i.typography.fontWeights.semibold,element:"h3"},h4:{fontSize:i.typography.fontSizes[400],lineHeight:i.typography.lineHeights[400],fontWeight:i.typography.fontWeights.medium,element:"h4"},body:{fontSize:i.typography.fontSizes[200],lineHeight:i.typography.lineHeights[200],fontWeight:i.typography.fontWeights.regular,element:"p"},small:{fontSize:i.typography.fontSizes[100],lineHeight:i.typography.lineHeights[100],fontWeight:i.typography.fontWeights.regular,element:"span"},tiny:{fontSize:i.typography.fontSizes[50],lineHeight:i.typography.lineHeights[50],fontWeight:i.typography.fontWeights.regular,element:"span"}},j={dark:i.theme.colorTextDark,medium:i.theme.colorTextMedium,light:i.theme.colorTextLight,primary:i.theme.colorPrimary},g=c[s],N=d||g.element,M={fontSize:g.fontSize,lineHeight:g.lineHeight,fontWeight:t?i.typography.fontWeights[t]:g.fontWeight,fontFamily:i.typography.fontFamilies[r],color:j[a],margin:0,...o};return e.jsx(N,{className:l,style:M,...h,children:n})},V=({variant:s="default",padding:a="medium",image:t,imageAlt:r="",imageHeight:l="200px",hover:n=!1,className:d="",children:o,...h})=>{const c={none:"",small:"p-4",medium:"p-6",large:"p-8"},j={default:{backgroundColor:i.theme.colorPage,boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",border:"none"},outlined:{backgroundColor:i.theme.colorPage,boxShadow:"none",border:`1px solid ${i.theme.colorBorder}`},elevated:{backgroundColor:i.theme.colorPage,boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"none"}},g=`
    rounded-lg
    transition-all duration-200 ease-in-out
    ${t?"overflow-hidden":""}
    ${t?"":c[a]}
    ${n?"hover:shadow-lg cursor-pointer transform hover:-translate-y-1":""}
    ${d}
  `.trim(),N={...j[s],borderRadius:i.borderRadius[500]};return e.jsxs("div",{className:g,style:N,...h,children:[t&&e.jsx("div",{className:"relative",children:e.jsx("img",{src:t,alt:r,className:"w-full object-cover",style:{height:l}})}),t?e.jsx("div",{className:c[a],children:o}):o]})},X=x.forwardRef(({label:s,error:a,helpText:t,variant:r="outlined",size:l="medium",className:n="",id:d,...o},h)=>{const c=d||`input-${Math.random().toString(36).substr(2,9)}`,j={small:"px-3 py-2 text-sm",medium:"px-4 py-2.5 text-base",large:"px-4 py-3 text-lg"},N={default:{backgroundColor:i.palette.gray[100],border:"none",focusBorder:i.theme.colorPrimary},outlined:{backgroundColor:i.theme.colorPage,border:`1px solid ${i.theme.colorBorder}`,focusBorder:i.theme.colorPrimary}}[r],M=`
    w-full
    rounded-lg
    transition-all duration-200 ease-in-out
    focus:outline-none focus:ring-2 focus:ring-opacity-50
    disabled:opacity-50 disabled:cursor-not-allowed
    ${j[l]}
    ${a?"border-red-500 focus:border-red-500 focus:ring-red-200":"focus:ring-blue-200"}
    ${n}
  `.trim(),z={backgroundColor:N.backgroundColor,border:N.border,borderRadius:i.borderRadius[500],color:i.theme.colorText,fontFamily:i.typography.fontFamilies.sans};return e.jsxs("div",{className:"w-full",children:[s&&e.jsx("label",{htmlFor:c,className:"block mb-2",children:e.jsx(m,{variant:"small",weight:"medium",color:"dark",children:s})}),e.jsx("input",{ref:h,id:c,className:M,style:z,...o}),a&&e.jsx("div",{className:"mt-1",children:e.jsx(m,{variant:"small",color:"light",className:"text-red-500",children:a})}),t&&!a&&e.jsx("div",{className:"mt-1",children:e.jsx(m,{variant:"small",color:"light",children:t})})]})});X.displayName="Input";const Q=({variant:s="default",size:a="medium",className:t="",children:r})=>{const l={small:"px-2 py-0.5 text-xs",medium:"px-2.5 py-1 text-sm",large:"px-3 py-1.5 text-base"},n={default:{backgroundColor:i.palette.gray[200],color:i.palette.gray[800]},primary:{backgroundColor:i.palette.blue[100],color:i.palette.blue[800]},secondary:{backgroundColor:i.palette.gray[100],color:i.palette.gray[700]},success:{backgroundColor:i.palette.green[100],color:i.palette.green[800]},warning:{backgroundColor:i.palette.yellow[100],color:i.palette.yellow[800]},danger:{backgroundColor:i.palette.red[100],color:i.palette.red[800]}},d=`
    inline-flex items-center
    font-medium rounded-full
    ${l[a]}
    ${t}
  `.trim(),o={...n[s],borderRadius:i.borderRadius.round,fontFamily:i.typography.fontFamilies.sans};return e.jsx("span",{className:d,style:o,children:r})},Re=({items:s,autoPlay:a=!1,autoPlayInterval:t=3e3,showDots:r=!0,showArrows:l=!0,itemsPerView:n=1,gap:d=16,className:o=""})=>{const[h,c]=x.useState(0),[j,g]=x.useState(!1),N=x.useRef(null),M=Math.max(0,s.length-n);x.useEffect(()=>{if(a&&!j&&s.length>n){const k=setInterval(()=>{c(p=>p>=M?0:p+1)},t);return()=>clearInterval(k)}},[a,t,j,s.length,n,M]);const z=k=>{c(Math.max(0,Math.min(M,k)))},w=()=>{c(k=>k<=0?M:k-1)},u=()=>{c(k=>k>=M?0:k+1)},C=`calc(${100/n}% - ${d*(n-1)/n}px)`,P=-(h*(100/n));return e.jsxs("div",{className:`relative ${o}`,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[e.jsx("div",{ref:N,className:"overflow-hidden",style:{borderRadius:i.borderRadius[500]},children:e.jsx("div",{className:"flex transition-transform duration-300 ease-in-out",style:{transform:`translateX(${P}%)`,gap:`${d}px`},children:s.map(k=>e.jsx("div",{className:"flex-shrink-0",style:{width:C},children:k.content},k.id))})}),l&&s.length>n&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:w,className:"absolute left-2 top-1/2 transform -translate-y-1/2 z-10 p-2 rounded-full bg-white shadow-lg hover:shadow-xl transition-all duration-200 opacity-80 hover:opacity-100",style:{backgroundColor:i.theme.colorPage,color:i.theme.colorText},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15,18 9,12 15,6"})})}),e.jsx("button",{onClick:u,className:"absolute right-2 top-1/2 transform -translate-y-1/2 z-10 p-2 rounded-full bg-white shadow-lg hover:shadow-xl transition-all duration-200 opacity-80 hover:opacity-100",style:{backgroundColor:i.theme.colorPage,color:i.theme.colorText},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})})]}),r&&s.length>n&&e.jsx("div",{className:"flex justify-center mt-6 space-x-2",children:Array.from({length:M+1}).map((k,p)=>e.jsx("button",{onClick:()=>z(p),className:"w-3 h-3 rounded-full transition-all duration-200 hover:scale-110",style:{backgroundColor:p===h?i.theme.colorPrimary:i.palette.gray[300]}},p))}),a&&!j&&e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-blue-500 transition-all duration-100 ease-linear",style:{width:`${(h+1)/(M+1)*100}%`,backgroundColor:i.theme.colorPrimary}})]})},De=({variant:s="default",fixed:a=!1,showLogo:t=!0,showSearch:r=!0,showAuth:l=!0,className:n=""})=>{const[d,o]=x.useState(!1),[h,c]=x.useState(""),j={default:{backgroundColor:i.theme.colorPage,borderBottom:`1px solid ${i.theme.colorBorder}`,backdropFilter:"none"},transparent:{backgroundColor:i.palette.alphaWhite[200],borderBottom:"none",backdropFilter:"blur(10px)"},solid:{backgroundColor:i.theme.colorPrimary,borderBottom:"none",backdropFilter:"none"}},g=s==="solid"?i.theme.colorPage:i.theme.colorText,N=s==="solid"?i.palette.alphaWhite[800]:i.theme.colorTextMedium,M=`
    w-full z-50 transition-all duration-300
    ${a?"fixed top-0 left-0":"relative"}
    ${n}
  `.trim(),z=[{label:"Home",href:"/",active:!0},{label:"Workflows",href:"/workflows",badge:"New"},{label:"Components",href:"/components"},{label:"Docs",href:"/docs"},{label:"About",href:"/about"}];return e.jsx("nav",{className:M,style:j[s],children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[t&&e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:s==="solid"?i.palette.alphaWhite[200]:i.theme.colorPrimary},children:e.jsx(m,{variant:"body",weight:"bold",style:{color:s==="solid"?i.theme.colorPrimary:i.theme.colorPage},children:"M"})}),e.jsx(m,{variant:"h4",weight:"bold",style:{color:g},children:"Musashi"})]})}),e.jsx("div",{className:"hidden md:flex items-center space-x-8",children:z.map((w,u)=>e.jsxs("div",{className:"relative flex items-center space-x-2",children:[e.jsx("a",{href:w.href,className:"transition-colors duration-200 hover:opacity-80",style:{color:w.active?g:N,fontWeight:w.active?i.typography.fontWeights.medium:i.typography.fontWeights.regular},children:w.label}),w.badge&&e.jsx(Q,{variant:"primary",size:"small",children:w.badge})]},u))}),e.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[r&&e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:h,onChange:w=>c(w.target.value),className:"w-64 px-4 py-2 text-sm rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2",style:{backgroundColor:s==="solid"?i.palette.alphaWhite[200]:i.palette.gray[100],borderColor:i.theme.colorBorder,color:i.theme.colorText}}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",style:{color:N},viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),l&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(U,{variant:s==="solid"?"tertiary":"secondary",size:"small",children:"Sign In"}),e.jsx(U,{variant:s==="solid"?"secondary":"primary",size:"small",children:"Get Started"})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx("button",{onClick:()=>o(!d),className:"p-2 rounded-md transition-colors duration-200",style:{color:g},children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]}),d&&e.jsx("div",{className:"md:hidden",children:e.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[z.map((w,u)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("a",{href:w.href,className:"block px-3 py-2 rounded-md transition-colors duration-200",style:{color:w.active?g:N,fontWeight:w.active?i.typography.fontWeights.medium:i.typography.fontWeights.regular},children:w.label}),w.badge&&e.jsx(Q,{variant:"primary",size:"small",children:w.badge})]},u)),r&&e.jsx("div",{className:"pt-4",children:e.jsx("input",{type:"text",placeholder:"Search...",value:h,onChange:w=>c(w.target.value),className:"w-full px-3 py-2 text-sm rounded-md border",style:{backgroundColor:s==="solid"?i.palette.alphaWhite[200]:i.palette.gray[100],borderColor:i.theme.colorBorder,color:i.theme.colorText}})}),l&&e.jsxs("div",{className:"pt-4 space-y-2",children:[e.jsx(U,{variant:s==="solid"?"tertiary":"secondary",size:"small",className:"w-full",children:"Sign In"}),e.jsx(U,{variant:s==="solid"?"secondary":"primary",size:"small",className:"w-full",children:"Get Started"})]})]})})]})})},Ve=({variant:s="default",showNewsletter:a=!0,showSocial:t=!0,className:r=""})=>{const l=new Date().getFullYear(),n={product:[{label:"Features",href:"/features"},{label:"Workflows",href:"/workflows"},{label:"Components",href:"/components"},{label:"Pricing",href:"/pricing"}],company:[{label:"About",href:"/about"},{label:"Blog",href:"/blog"},{label:"Careers",href:"/careers"},{label:"Contact",href:"/contact"}],resources:[{label:"Documentation",href:"/docs"},{label:"Help Center",href:"/help"},{label:"Community",href:"/community"},{label:"API Reference",href:"/api"}],legal:[{label:"Privacy Policy",href:"/privacy"},{label:"Terms of Service",href:"/terms"},{label:"Cookie Policy",href:"/cookies"},{label:"Security",href:"/security"}]},d=[{name:"GitHub",href:"https://github.com",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})},{name:"Twitter",href:"https://twitter.com",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})})},{name:"LinkedIn",href:"https://linkedin.com",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})},{name:"Discord",href:"https://discord.com",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 00-5.487 0 12.64 12.64 0 00-.617-1.25.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.07.07 0 00-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028 14.09 14.09 0 001.226-1.994.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 00-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})})}];return s==="minimal"?e.jsx("footer",{className:`py-8 ${r}`,style:{backgroundColor:i.palette.gray[100],borderTop:`1px solid ${i.theme.colorBorder}`},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4 md:mb-0",children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center",style:{backgroundColor:i.theme.colorPrimary},children:e.jsx(m,{variant:"small",weight:"bold",style:{color:i.theme.colorPage},children:"M"})}),e.jsx(m,{variant:"body",weight:"medium",children:"Musashi"})]}),e.jsxs(m,{variant:"small",color:"light",children:["© ",l," Musashi. All rights reserved."]})]})})}):e.jsxs("footer",{className:`${r}`,style:{backgroundColor:i.palette.gray[900]},children:[a&&s==="detailed"&&e.jsx("div",{className:"py-12",style:{backgroundColor:i.palette.gray[800]},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(m,{variant:"h3",className:"mb-4",style:{color:i.theme.colorPage},children:"Stay up to date"}),e.jsx(m,{variant:"body",className:"mb-8",style:{color:i.palette.gray[300]},children:"Get the latest news, updates, and tips delivered straight to your inbox."}),e.jsxs("div",{className:"max-w-md mx-auto flex space-x-3",children:[e.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-4 py-3 rounded-lg border text-sm focus:outline-none focus:ring-2",style:{backgroundColor:i.theme.colorPage,borderColor:i.palette.gray[600],color:i.theme.colorText}}),e.jsx(U,{variant:"primary",children:"Subscribe"})]})]})})}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:i.theme.colorPrimary},children:e.jsx(m,{variant:"body",weight:"bold",style:{color:i.theme.colorPage},children:"M"})}),e.jsx(m,{variant:"h4",weight:"bold",style:{color:i.theme.colorPage},children:"Musashi"})]}),e.jsx(m,{variant:"body",className:"mb-6",style:{color:i.palette.gray[400]},children:"AI Agent Workflow Design Tool that focuses on visual workflow creation. Cut the code. Shape the flow."}),t&&e.jsx("div",{className:"flex space-x-4",children:d.map(o=>e.jsx("a",{href:o.href,className:"p-2 rounded-lg transition-colors duration-200 hover:bg-gray-800",style:{color:i.palette.gray[400]},title:o.name,children:o.icon},o.name))})]}),s==="detailed"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Product"}),e.jsx("ul",{className:"space-y-3",children:n.product.map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Company"}),e.jsx("ul",{className:"space-y-3",children:n.company.map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Resources"}),e.jsx("ul",{className:"space-y-3",children:n.resources.map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Legal"}),e.jsx("ul",{className:"space-y-3",children:n.legal.map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]})]}):e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Product"}),e.jsx("ul",{className:"space-y-2",children:n.product.slice(0,3).map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"text-sm transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Company"}),e.jsx("ul",{className:"space-y-2",children:n.company.slice(0,3).map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"text-sm transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Resources"}),e.jsx("ul",{className:"space-y-2",children:n.resources.slice(0,3).map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"text-sm transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"semibold",className:"mb-4",style:{color:i.theme.colorPage},children:"Legal"}),e.jsx("ul",{className:"space-y-2",children:n.legal.slice(0,3).map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,className:"text-sm transition-colors duration-200 hover:opacity-80",style:{color:i.palette.gray[400]},children:o.label})},o.label))})]})]})})]})})}),e.jsx("div",{className:"py-6",style:{borderTop:`1px solid ${i.palette.gray[800]}`},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs(m,{variant:"small",style:{color:i.palette.gray[500]},children:["© ",l," Musashi. All rights reserved."]}),e.jsx("div",{className:"flex items-center space-x-6 mt-4 md:mt-0",children:e.jsx(m,{variant:"small",style:{color:i.palette.gray[500]},children:"Made with ❤️ by the Musashi Team"})})]})})})]})},Be=({variant:s="default",backgroundImage:a,overlay:t=!0,showBadge:r=!1,badgeText:l="New",title:n,subtitle:d,description:o,primaryAction:h,secondaryAction:c,features:j=[],stats:g=[],className:N=""})=>{const M=(w,u=!0)=>{const C=e.jsx(U,{variant:u?"primary":"secondary",size:"large",onClick:w.onClick,children:w.text});return w.href?e.jsx("a",{href:w.href,children:C}):C},z=`relative overflow-hidden ${N}`;return s==="minimal"?e.jsx("section",{className:z,children:e.jsx("div",{className:"py-20",style:{backgroundColor:i.palette.gray[50]},children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r&&e.jsx("div",{className:"mb-6",children:e.jsx(Q,{variant:"primary",children:l})}),e.jsx(m,{variant:"h1",className:"mb-6",children:n}),o&&e.jsx(m,{variant:"body",color:"light",className:"mb-8 max-w-2xl mx-auto",children:o}),(h||c)&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[h&&M(h,!0),c&&M(c,!1)]})]})})}):s==="split"?e.jsx("section",{className:z,children:e.jsx("div",{className:"min-h-screen flex items-center",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"space-y-8",children:[r&&e.jsx(Q,{variant:"primary",children:l}),e.jsxs("div",{children:[d&&e.jsx(m,{variant:"body",color:"primary",weight:"medium",className:"mb-4",children:d}),e.jsx(m,{variant:"h1",className:"mb-6",children:n}),o&&e.jsx(m,{variant:"body",color:"light",className:"mb-8",children:o})]}),j.length>0&&e.jsx("div",{className:"space-y-3",children:j.map((w,u)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center",style:{backgroundColor:i.palette.green[100]},children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",style:{color:i.palette.green[600]},viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx(m,{variant:"body",children:w})]},u))}),(h||c)&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[h&&M(h,!0),c&&M(c,!1)]}),g.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-8 pt-8 border-t",style:{borderColor:i.theme.colorBorder},children:g.map((w,u)=>e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx(m,{variant:"h3",color:"primary",className:"mb-1",children:w.value}),e.jsx(m,{variant:"small",color:"light",children:w.label})]},u))})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"aspect-square rounded-2xl",style:{background:`linear-gradient(135deg, ${i.palette.blue[100]} 0%, ${i.palette.purple[100]} 100%)`},children:a?e.jsx("img",{src:a,alt:"Hero visual",className:"w-full h-full object-cover rounded-2xl"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-2xl mx-auto mb-4 flex items-center justify-center",style:{backgroundColor:i.theme.colorPrimary},children:e.jsx(m,{variant:"h2",style:{color:i.theme.colorPage},children:"M"})}),e.jsx(m,{variant:"h4",color:"primary",children:"Musashi"})]})})})})]})})})}):s==="centered"?e.jsxs("section",{className:z,style:{backgroundImage:a?`url(${a})`:"none",backgroundSize:"cover",backgroundPosition:"center"},children:[t&&a&&e.jsx("div",{className:"absolute inset-0",style:{backgroundColor:i.palette.alphaBlack[500]}}),e.jsx("div",{className:"relative min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r&&e.jsx("div",{className:"mb-6",children:e.jsx(Q,{variant:"primary",children:l})}),d&&e.jsx(m,{variant:"body",color:a?"light":"primary",weight:"medium",className:"mb-4",style:a?{color:i.palette.gray[300]}:{},children:d}),e.jsx(m,{variant:"h1",className:"mb-6",style:a?{color:i.theme.colorPage}:{},children:n}),o&&e.jsx(m,{variant:"body",className:"mb-8 max-w-3xl mx-auto",style:a?{color:i.palette.gray[300]}:{color:i.theme.colorTextLight},children:o}),(h||c)&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[h&&M(h,!0),c&&M(c,!1)]}),g.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-8 max-w-2xl mx-auto",children:g.map((w,u)=>e.jsxs("div",{className:"text-center",children:[e.jsx(m,{variant:"h2",className:"mb-2",style:a?{color:i.theme.colorPage}:{color:i.theme.colorPrimary},children:w.value}),e.jsx(m,{variant:"body",style:a?{color:i.palette.gray[300]}:{color:i.theme.colorTextLight},children:w.label})]},u))})]})})]}):e.jsxs("section",{className:z,style:{backgroundImage:a?`url(${a})`:`linear-gradient(135deg, ${i.palette.blue[50]} 0%, ${i.palette.purple[50]} 100%)`,backgroundSize:"cover",backgroundPosition:"center"},children:[t&&a&&e.jsx("div",{className:"absolute inset-0",style:{backgroundColor:i.palette.alphaBlack[400]}}),e.jsx("div",{className:"relative py-24 sm:py-32",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[r&&e.jsx("div",{className:"mb-6",children:e.jsx(Q,{variant:"primary",children:l})}),d&&e.jsx(m,{variant:"body",color:a?"light":"primary",weight:"medium",className:"mb-4",style:a?{color:i.palette.gray[300]}:{},children:d}),e.jsx(m,{variant:"h1",className:"mb-6 max-w-4xl mx-auto",style:a?{color:i.theme.colorPage}:{},children:n}),o&&e.jsx(m,{variant:"body",className:"mb-10 max-w-3xl mx-auto",style:a?{color:i.palette.gray[300]}:{color:i.theme.colorTextLight},children:o}),(h||c)&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-16",children:[h&&M(h,!0),c&&M(c,!1)]}),j.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 max-w-4xl mx-auto",children:j.map((w,u)=>e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center",style:{backgroundColor:i.palette.green[100]},children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",style:{color:i.palette.green[600]},viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx(m,{variant:"body",style:a?{color:i.palette.gray[300]}:{},children:w})]},u))})]})})})]})},Ht=({isOpen:s,onClose:a})=>{const t=x.useRef(null);if(x.useEffect(()=>{const l=d=>{t.current&&!t.current.contains(d.target)&&a()},n=d=>{d.key==="Escape"&&a()};return s&&(document.addEventListener("mousedown",l),document.addEventListener("keydown",n)),()=>{document.removeEventListener("mousedown",l),document.removeEventListener("keydown",n)}},[s,a]),!s)return null;const r=[{title:"편집 작업",shortcuts:[{keys:["Ctrl/Cmd","Z"],description:"실행 취소"},{keys:["Ctrl/Cmd","Shift","Z"],description:"다시 실행"},{keys:["Ctrl/Cmd","Y"],description:"다시 실행 (대체)"},{keys:["Delete"],description:"선택된 노드 삭제"}]},{title:"파일 작업",shortcuts:[{keys:["Ctrl/Cmd","S"],description:"워크플로우 저장"},{keys:["Ctrl/Cmd","E"],description:"워크플로우 내보내기"}]},{title:"자동 저장",shortcuts:[{keys:["자동"],description:"매 1분마다 자동 저장"}]}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fadeIn",children:e.jsxs("div",{ref:t,className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden animate-slideUp",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx(m,{variant:"h2",className:"text-gray-900",children:"키보드 단축키"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close modal",children:e.jsx(Ne,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-88px)]",children:[r.map((l,n)=>e.jsxs("div",{className:n>0?"mt-6":"",children:[e.jsx(m,{variant:"h4",className:"text-gray-700 mb-3",children:l.title}),e.jsx("div",{className:"space-y-2",children:l.shortcuts.map((d,o)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex items-center space-x-2",children:d.keys.map((h,c)=>e.jsxs(Ye.Fragment,{children:[c>0&&e.jsx(m,{variant:"small",className:"text-gray-400 mx-1",children:"+"}),e.jsx("kbd",{className:"px-2 py-1 text-sm font-semibold text-gray-800 bg-gray-100 border border-gray-300 rounded-md shadow-sm",children:h})]},c))}),e.jsx(m,{variant:"body",className:"text-gray-600",children:d.description})]},o))})]},n)),e.jsx(V,{variant:"outlined",className:"mt-6 p-4 bg-blue-50 border-blue-200",children:e.jsxs(m,{variant:"body",className:"text-blue-700",children:[e.jsx("strong",{children:"팁:"})," Ctrl 키는 Windows/Linux에서, Cmd 키는 macOS에서 사용됩니다."]})})]})]})})},Ft=({isOpen:s,onClose:a,systemPrompt:t,nodeName:r})=>{const[l,n]=x.useState(!1),[d,o]=x.useState(!1),[h,c]=x.useState(!1),[j,g]=x.useState(""),[N,M]=x.useState(!1);x.useEffect(()=>{s||(n(!1),o(!1),g(""),M(!1))},[s]),x.useEffect(()=>{const P=k=>{k.key==="Escape"&&(l?n(!1):a()),(k.metaKey||k.ctrlKey)&&k.key==="f"&&s&&(k.preventDefault(),M(!N))};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[s,l,a,N]);const z=async()=>{try{await navigator.clipboard.writeText(t),c(!0),setTimeout(()=>c(!1),2e3)}catch(P){console.error("Failed to copy:",P)}},w=P=>{let k=P;if(j){const S=new RegExp(`(${j})`,"gi");k=P.replace(S,'<mark style="background: yellow;">$1</mark>')}return k.split(`
`).map((S,_)=>{if(S.startsWith("### "))return e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,marginTop:"16px",marginBottom:"8px"},dangerouslySetInnerHTML:{__html:S.substring(4)}},_);if(S.startsWith("## "))return e.jsx("h2",{style:{fontSize:"18px",fontWeight:700,marginTop:"20px",marginBottom:"10px"},dangerouslySetInnerHTML:{__html:S.substring(3)}},_);if(S.startsWith("# "))return e.jsx("h1",{style:{fontSize:"20px",fontWeight:800,marginTop:"24px",marginBottom:"12px"},dangerouslySetInnerHTML:{__html:S.substring(2)}},_);if(S.startsWith("```"))return e.jsx("div",{style:{fontFamily:"monospace",background:"#f3f4f6",padding:"2px 4px",borderRadius:"4px",fontSize:"13px"},children:S},_);if(S.startsWith("- ")||S.startsWith("* "))return e.jsx("li",{style:{marginLeft:"20px",marginTop:"4px"},dangerouslySetInnerHTML:{__html:S.substring(2)}},_);if(S.match(/^\d+\. /))return e.jsx("li",{style:{marginLeft:"20px",marginTop:"4px",listStyleType:"decimal"},dangerouslySetInnerHTML:{__html:S.replace(/^\d+\. /,"")}},_);let $=S.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,'<code style="background: #f3f4f6; padding: 2px 4px; border-radius: 3px; font-family: monospace; font-size: 13px;">$1</code>');return S.trim()?e.jsx("p",{style:{marginTop:"8px"},dangerouslySetInnerHTML:{__html:$}},_):e.jsx("br",{},_)})};if(!s)return null;const u=t.split(/\s+/).filter(P=>P.length>0).length,C=t.length;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:a}),e.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl ${l?"w-full h-full m-0":"w-full max-w-4xl h-[80vh] mx-4"} flex flex-col transition-all duration-300`,style:{animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"System Prompt"}),e.jsx("p",{className:"text-sm text-gray-500",children:r})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:z,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Copy to clipboard",children:h?e.jsx(es,{className:"w-4 h-4 text-green-600"}):e.jsx(ts,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:()=>M(!N),className:`p-2 hover:bg-gray-100 rounded-lg transition-colors ${N?"bg-gray-100":""}`,title:"Search (Ctrl+F)",children:e.jsx(dt,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:()=>n(!l),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:l?"Exit fullscreen":"Fullscreen",children:l?e.jsx(vs,{className:"w-4 h-4 text-gray-600"}):e.jsx(js,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors ml-2",title:"Close (ESC)",children:e.jsx(Ne,{className:"w-4 h-4 text-gray-600"})})]})]}),N&&e.jsx("div",{className:"px-6 py-3 border-b bg-gray-50",children:e.jsx("input",{type:"text",value:j,onChange:P=>g(P.target.value),placeholder:"Search in prompt...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:d?e.jsx("pre",{className:"font-mono text-sm text-gray-700 whitespace-pre-wrap",children:j?e.jsx("div",{dangerouslySetInnerHTML:{__html:t.replace(new RegExp(`(${j})`,"gi"),'<mark style="background: yellow;">$1</mark>')}}):t}):e.jsx("div",{className:"prose prose-sm max-w-none",children:w(t)})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>o(!d),className:`px-3 py-1 text-sm rounded-lg transition-colors ${d?"bg-gray-200 text-gray-800":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Raw"}),e.jsx("button",{onClick:()=>o(!d),className:`px-3 py-1 text-sm rounded-lg transition-colors ${d?"bg-white text-gray-600 hover:bg-gray-100":"bg-gray-200 text-gray-800"}`,children:"Markdown"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[u," words · ",C," characters"]})]})]})]})},Ut={direction:"TB",nodeSpacing:200,rankSpacing:300,nodeWidth:200,nodeHeight:60};function xe(s,a,t={}){const r={...Ut,...t},{direction:l,nodeSpacing:n,rankSpacing:d,nodeWidth:o,nodeHeight:h}=r,c=new os.graphlib.Graph({directed:!0,multigraph:!0,compound:!1});c.setGraph({rankdir:l,nodesep:n,ranksep:d,marginx:100,marginy:100,ranker:"longest-path",edgesep:150}),c.setDefaultEdgeLabel(()=>({})),s.forEach(u=>{c.setNode(u.id,{width:o,height:h})}),a.forEach(u=>{c.setEdge(u.source,u.target)}),os.layout(c);const j=s.map(u=>{const C=c.node(u.id),P={x:C.x-o/2,y:C.y-h/2};return{...u,position:P,draggable:!1}}),g=j.reduce((u,C)=>({minX:Math.min(u.minX,C.position.x),minY:Math.min(u.minY,C.position.y),maxX:Math.max(u.maxX,C.position.x+o),maxY:Math.max(u.maxY,C.position.y+h)}),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),N=50,M=g.minX<N?N-g.minX:0,z=g.minY<N?N-g.minY:0;return{nodes:j.map(u=>({...u,position:{x:u.position.x+M,y:u.position.y+z}})),edges:a}}function Rt(s,a,t,r){const l={...t,position:{x:0,y:0},draggable:!1},n=[...s,l];return xe(n,a,r)}function Vt(s,a,t,r){const l=s.filter(d=>d.id!==t),n=a.filter(d=>d.source!==t&&d.target!==t);return xe(l,n,r)}function xs(s,a,t,r){const l=[...a,t];return xe(s,l,r)}function qt(s,a,t,r){const l=a.filter(n=>n.id!==t);return xe(s,l,r)}const Kt=s=>{const a=Math.random().toString(36).substring(2,8);return`${s}_${a}`},Zt=()=>({nodes:[],edges:[]}),Qe=()=>{const{id:s}=Bs(),a=Xe(),t=s||"new",[r,l]=x.useState(null),[n,d]=x.useState("New Workflow"),[o,h]=x.useState([]),[c,j]=x.useState([]),[g,N]=x.useState(null),[M,z]=x.useState(!1),[w,u]=x.useState(!1),[C,P]=x.useState({type:"info",message:"",show:!1}),[k,p]=x.useState(!1),[S,_]=x.useState({isOpen:!1,systemPrompt:"",nodeName:""}),[$,W]=x.useState([]),[y,Z]=x.useState(-1),Y=x.useRef(!1),se=50,[ee,E]=x.useState(null),B=x.useCallback((f,b)=>{P({type:f,message:b,show:!0}),setTimeout(()=>{P(I=>({...I,show:!1}))},3e3)},[]),R=x.useCallback((f,b)=>{if(Y.current){Y.current=!1;return}const I=$.slice(0,y+1);I.push({nodes:f,edges:b}),I.length>se&&I.shift(),W(I),Z(I.length-1)},[$,y]),q=x.useCallback(()=>{if(y>0){const f=y-1,b=$[f];Y.current=!0,h(b.nodes),j(b.edges),Z(f),B("info","Undone")}},[$,y,B]),le=x.useCallback(()=>{if(y<$.length-1){const f=y+1,b=$[f];Y.current=!0,h(b.nodes),j(b.edges),Z(f),B("info","Redone")}},[$,y,B]),te=x.useCallback(f=>{const b=Vt(o,c,f);h(b.nodes),j(b.edges),N(null)},[o,c]),pe=x.useCallback(()=>{const f={name:n,nodes:o.map(A=>{var T;return{id:A.id,type:A.type,label:(T=A.data)==null?void 0:T.label,properties:A.data}}),edges:c.map(A=>({id:A.id,source:A.source,target:A.target,label:A.label}))},b=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),I=URL.createObjectURL(b),L=document.createElement("a");L.href=I,L.download=`${n||"workflow"}.json`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(I)},[o,c,n]),ce=x.useCallback((f,b,I)=>{var G;const L=c.find(F=>F.id===b);if(!L)return;const A=o.find(F=>F.id===L.source);if(!A||!((G=A.data)!=null&&G.outputs))return;const T=A.data.outputs.find(F=>F.key===I);if(!T)return;const H=f.target.getBoundingClientRect();E({edgeId:b,outputKey:T.key,outputType:T.type||"string",outputExample:T.example,position:{x:H.left+H.width/2,y:H.top}})},[c,o]),Me=x.useCallback(async()=>{try{z(!0);const f=await ye.getWorkflow(t);l(f),d(f.name);const b=f.nodes.map(T=>{var J;let H=T.type;["userinput","agent","vectorstore","knowledgebase","mcp","apicall","router","finaloutput"].includes(H)||(H="default");const F={label:T.label,name:((J=T.properties)==null?void 0:J.name)||T.label,...T.properties};return H==="agent"&&(F.inputs&&!F.connected_inputs&&(F.connected_inputs=[]),F.connected_inputs||(F.connected_inputs=[]),delete F.inputs,(!F.outputs||F.outputs.length===0)&&(F.outputs=[{key:"output1",type:"string",example:""}]),F.parameters||(F.parameters={model:"",temperature:1,max_tokens:1e4,top_p:1,system_prompt:""})),(!F.outputs||F.outputs.length===0)&&(F.outputs=[{key:"output",type:"string",example:""}]),{id:T.id,type:H,data:F,position:{x:T.position_x||0,y:T.position_y||0},draggable:!1}}),I=f.edges.map(T=>{var F;const H=((F=T.data)==null?void 0:F.direction)||"unidirectional",G={id:T.id,source:T.source,target:T.target,sourceHandle:T.sourceHandle,label:T.label,type:"custom",animated:!0,data:{source:T.source,target:T.target,sourceHandle:T.sourceHandle,sourceOutput:T.sourceHandle?T.sourceHandle.replace("output-",""):void 0,onLabelClick:ce,direction:H},markerEnd:{type:"arrowclosed",width:11,height:11,color:"#374151"},style:{stroke:"#374151",strokeWidth:3}};return H==="bidirectional"&&(G.markerStart={type:"arrowclosed",width:11,height:11,color:"#374151"}),G}),L=xe(b,I),A=L.nodes.map(T=>{if(T.type==="agent"){const H=L.edges.filter(F=>F.target===T.id),G=[];return H.forEach(F=>{var ke,Ce,ne,de,ge;const J=L.nodes.find(ae=>ae.id===F.source);if(J){const ae=((ke=F.sourceHandle)==null?void 0:ke.replace("output-",""))||"output",me=(ne=(Ce=J.data)==null?void 0:Ce.outputs)==null?void 0:ne.find(Es=>Es.key===ae);me&&G.push({nodeId:J.id,nodeName:((de=J.data)==null?void 0:de.name)||((ge=J.data)==null?void 0:ge.label)||"Unknown",outputKey:me.key,outputType:me.type||"string",outputExample:me.example})}}),{...T,data:{...T.data,connected_inputs:G}}}return T});h(A),j(L.edges),W([{nodes:A,edges:L.edges}]),Z(0)}catch{P({type:"error",message:"Failed to load workflow",show:!0}),setTimeout(()=>{P(b=>({...b,show:!1}))},3e3)}finally{z(!1)}},[t,ce]);x.useCallback((f,b)=>{const I={name:n,nodes:f,edges:b,timestamp:new Date().toISOString()};localStorage.setItem(`workflow_${t}`,JSON.stringify(I))},[t,n]),x.useEffect(()=>{if(t==="new"){const f=Zt();h(f.nodes),j(f.edges),W([{nodes:f.nodes,edges:f.edges}]),Z(0);const b={name:n,nodes:f.nodes,edges:f.edges,timestamp:new Date().toISOString()};localStorage.setItem(`workflow_${t}`,JSON.stringify(b))}else Me()},[t]),x.useEffect(()=>{if(o.length>0||c.length>0){const f={name:n,nodes:o,edges:c,timestamp:new Date().toISOString()};localStorage.setItem(`workflow_${t}`,JSON.stringify(f)),Y.current||R(o,c)}},[o,c,t,n]),x.useEffect(()=>{if(t==="new"||!r)return;const f=setInterval(()=>{o.length>0&&D(!0)},6e4);return()=>clearInterval(f)},[t,r,o.length]),x.useEffect(()=>{const f=b=>{const{nodeName:I,systemPrompt:L}=b.detail;_({isOpen:!0,systemPrompt:L||"",nodeName:I||"Agent"})};return window.addEventListener("openSystemPromptModal",f),()=>{window.removeEventListener("openSystemPromptModal",f)}},[]);const Ee=x.useCallback((f,b)=>{N(b)},[]),Le=x.useCallback(()=>{N(null),E(null)},[]),Te=x.useCallback(f=>{},[]),Ie=x.useCallback(f=>{f.forEach(b=>{var I,L;if(b.type==="remove"){const A=c.find(T=>T.id===b.id);if(A){const T=o.find(H=>H.id===A.target);if((T==null?void 0:T.type)==="agent"){const H=((I=A.sourceHandle)==null?void 0:I.replace("output-",""))||"output",G=(((L=T.data)==null?void 0:L.connected_inputs)||[]).filter(J=>!(J.nodeId===A.source&&J.outputKey===H)),F=o.map(J=>J.id===T.id?{...J,data:{...J.data,connected_inputs:G}}:J);h(F)}}}})},[c,o]),Ae=x.useCallback(f=>{var G,F,J,ke,Ce;if(!f.source||!f.target)return;const b=o.find(ne=>ne.id===f.source),I=o.find(ne=>ne.id===f.target);if(!b||!I)return;let L=[...o];if(I.type==="agent"){const ne=((G=f.sourceHandle)==null?void 0:G.replace("output-",""))||"output",de=(J=(F=b.data)==null?void 0:F.outputs)==null?void 0:J.find(ge=>ge.key===ne);if(de){const ge={nodeId:b.id,nodeName:((ke=b.data)==null?void 0:ke.name)||((Ce=b.data)==null?void 0:Ce.label)||"Unknown",outputKey:de.key,outputType:de.type||"string",outputExample:de.example};L=L.map(ae=>{var me;return ae.id===I.id?{...ae,data:{...ae.data,connected_inputs:[...((me=ae.data)==null?void 0:me.connected_inputs)||[],ge]}}:ae})}}const A={id:`${f.source}-${f.target}`,source:f.source,target:f.target,sourceHandle:f.sourceHandle||void 0,targetHandle:f.targetHandle||void 0,type:"custom",markerEnd:{type:"arrowclosed"}},{nodes:T,edges:H}=xs(L,[...c,A]);h(T),j(H)},[o,c]),ze=x.useCallback((f,b)=>{const I={label:b,name:b,memo:""};f==="userinput"&&(I.outputs=[{key:"output1",type:"string",example:""}]),f==="agent"&&(I.connected_inputs=[],I.outputs=[{key:"output1",type:"string",example:""}],I.parameters={model:"",temperature:1,max_tokens:1e4,top_p:1,system_prompt:""}),f!=="agent"&&f!=="userinput"&&(I.outputs=[{key:"output",type:"string",example:""}]);const L={id:Kt(f),type:f,data:I,draggable:!1},A=Rt(o,c,L);h(A.nodes),j(A.edges)},[o,c]),We=x.useCallback((f,b)=>{h(I=>{const L=I.map(T=>T.id===f?b.data?{...T,...b,data:{...T.data,...b.data}}:{...T,...b}:T);return xe(L,c).nodes})},[c]),Pe=x.useCallback((f,b,I)=>{if(c.find(H=>H.source===f&&H.target===b&&H.sourceHandle===I)){B("info","This connection already exists");return}const A={id:`edge_${f}_to_${b}_${Date.now()}`,source:f,target:b,sourceHandle:I,type:"custom",animated:!0,data:{source:f,target:b,sourceHandle:I,sourceOutput:I?I.replace("output-",""):void 0,onLabelClick:ce,direction:"unidirectional"},markerEnd:{type:"arrowclosed",width:11,height:11,color:"#374151"},style:{stroke:"#374151",strokeWidth:3}},T=xs(o,c,A);h(T.nodes),j(T.edges)},[o,c,B,ce]),Oe=x.useCallback(f=>{const b=qt(o,c,f);h(b.nodes),j(b.edges)},[o,c]),v=x.useCallback((f,b)=>{j(I=>I.map(L=>{if(L.id===f){const A={...L,data:{...L.data,direction:b}};return b==="bidirectional"?A.markerStart={type:"arrowclosed",width:11,height:11,color:"#374151"}:delete A.markerStart,A}return L}))},[]),D=x.useCallback(async(f=!1)=>{try{u(!0);const b=o.map(L=>{var A,T,H;return{id:L.id,type:L.type||"default",label:((A=L.data)==null?void 0:A.label)||"",properties:L.data||{},position_x:(T=L.position)==null?void 0:T.x,position_y:(H=L.position)==null?void 0:H.y}}),I=c.map(L=>({id:L.id,source:L.source,target:L.target,label:typeof L.label=="string"?L.label:"",sourceHandle:L.sourceHandle,data:L.data||{}}));if(t==="new"||!r){const L=await ye.createWorkflow({name:n,description:"Created with Musashi Flow Editor",nodes:b,edges:I,metadata:{editor:"musashi-flow"}});l(L),f||B("success","Workflow created successfully!");const A=L.id||L._id;a(`/workflow/${A}`,{replace:!0})}else{const L=await ye.updateWorkflow(r.id,{name:n,nodes:b,edges:I});l(L),f||B("success","Workflow saved successfully!")}}catch(b){f||B("error",b instanceof Error?b.message:"Failed to save workflow")}finally{u(!1)}},[t,r,o,c,n,a,B]),K=x.useCallback(f=>{var L;const b=(L=f.target.files)==null?void 0:L[0];if(!b)return;const I=new FileReader;I.onload=A=>{var T;try{const H=JSON.parse((T=A.target)==null?void 0:T.result);if(H.nodes&&H.edges){const G=xe(H.nodes,H.edges);h(G.nodes),j(G.edges),d(H.name||"Imported Workflow"),W([{nodes:G.nodes,edges:G.edges}]),Z(0),B("success","Workflow imported successfully")}else B("error","Invalid workflow file format")}catch(H){console.error("Failed to import workflow:",H),B("error","Failed to import workflow. Invalid file format.")}},I.readAsText(b),f.target.value=""},[B]);return x.useEffect(()=>{const f=b=>{(b.metaKey||b.ctrlKey)&&b.key==="z"&&!b.shiftKey&&(b.preventDefault(),q()),(b.metaKey||b.ctrlKey)&&(b.key==="z"&&b.shiftKey||b.key==="y")&&(b.preventDefault(),le()),b.key==="Delete"&&g&&(b.preventDefault(),te(g.id)),(b.metaKey||b.ctrlKey)&&b.key==="s"&&(b.preventDefault(),D(!1)),(b.metaKey||b.ctrlKey)&&b.key==="e"&&(b.preventDefault(),pe())};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[g,q,le,te,pe,D]),M?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-musashi-600"})}):e.jsxs("div",{className:"h-screen flex flex-col",children:[C.show&&e.jsxs("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-md shadow-lg flex items-center space-x-2 ${C.type==="success"?"bg-green-50 text-green-800 border border-green-200":C.type==="error"?"bg-red-50 text-red-800 border border-red-200":"bg-blue-50 text-blue-800 border border-blue-200"}`,children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:C.message})]}),e.jsx("header",{className:"bg-white shadow-sm border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a("/dashboard"),className:"p-2 text-gray-400 hover:text-gray-600",title:"Back to Dashboard",children:e.jsx(ps,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("input",{type:"text",value:n,onChange:f=>d(f.target.value),className:"text-lg font-semibold text-gray-900 bg-transparent border-b border-transparent hover:border-gray-300 focus:border-musashi-500 focus:outline-none px-1",placeholder:"Workflow Name"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Musashi Flow Editor - Auto-layout workflow design"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Dt,{onAddNode:ze}),e.jsxs("div",{className:"flex items-center space-x-1 border-l pl-4",children:[e.jsx("button",{onClick:q,disabled:y<=0,className:"p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Undo (Ctrl+Z)",children:e.jsx(xt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:le,disabled:y>=$.length-1,className:"p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Redo (Ctrl+Shift+Z)",children:e.jsx(it,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:pe,className:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 flex items-center",children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs("label",{className:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 flex items-center cursor-pointer",children:[e.jsx(ut,{className:"w-4 h-4 mr-2"}),"Import",e.jsx("input",{type:"file",accept:".json",onChange:K,className:"hidden"})]}),e.jsxs("button",{onClick:()=>D(!1),disabled:w,className:`px-3 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white flex items-center ${w?"bg-gray-400 cursor-not-allowed":"bg-musashi-600 hover:bg-musashi-700"}`,children:[w?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(ct,{className:"w-4 h-4 mr-2"}),w?"Saving...":"Save"]}),e.jsx("button",{onClick:()=>p(!0),className:"p-2 border border-gray-300 rounded-md text-gray-600 bg-white hover:bg-gray-50 hover:text-gray-900 transition-colors ml-2",title:"키보드 단축키 (i)",children:e.jsx(lt,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Et,{nodes:o,edges:c,onNodeClick:Ee,onPaneClick:Le,onNodesChange:Te,onEdgesChange:Ie,onConnect:Ae,nodeTypes:ks,edgeTypes:Cs,fitView:!0,fitViewOptions:{padding:.2}}),g&&e.jsx(Ot,{selectedNode:g,nodes:o,edges:c,onClose:()=>N(null),onUpdateNode:We,onDeleteNode:te,onAddConnection:Pe,onRemoveConnection:Oe,onUpdateEdgeDirection:v}),ee&&e.jsx(Bt,{outputKey:ee.outputKey,outputType:ee.outputType,outputExample:ee.outputExample,position:ee.position,onClose:()=>E(null)})]}),e.jsx(Ht,{isOpen:k,onClose:()=>p(!1)}),e.jsx(Ft,{isOpen:S.isOpen,onClose:()=>_({isOpen:!1,systemPrompt:"",nodeName:""}),systemPrompt:S.systemPrompt,nodeName:S.nodeName})]})},Gt=()=>{const{register:s,handleSubmit:a,formState:{errors:t}}=Hs(),{login:r,isAuthenticated:l}=Fe(),[n,d]=x.useState(!1),[o,h]=x.useState(""),c=Xe();x.useEffect(()=>{l&&c("/dashboard")},[l,c]);const j=async g=>{try{d(!0),h(""),await r(g.username,g.password)}catch(N){h(N instanceof Error?N.message:"Login failed")}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to Musashi"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Cut the code. Shape the flow."})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:a(j),children:[o&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:o})}),e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"sr-only",children:"Username"}),e.jsx("input",{...s("username",{required:"Username is required",maxLength:{value:50,message:"Username must be 50 characters or less"}}),type:"text",maxLength:50,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-musashi-500 focus:border-musashi-500 focus:z-10 sm:text-sm",placeholder:"Username (max 50 characters)"}),t.username&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{...s("password",{required:"Password is required"}),type:"password",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-musashi-500 focus:border-musashi-500 focus:z-10 sm:text-sm",placeholder:"Password"}),t.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.password.message})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:n,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-musashi-600 hover:bg-musashi-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-musashi-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Signing in...":"Sign in"})})]})]})})},Jt=()=>{console.log("AdminDashboard: Component rendering");const{user:s,logout:a}=Fe(),t=Xe(),[r,l]=x.useState([]),[n,d]=x.useState(!0),[o,h]=x.useState(!1),[c,j]=x.useState(null),[g,N]=x.useState(null),[M,z]=x.useState(!1),[w,u]=x.useState(""),[C,P]=x.useState("");console.log("AdminDashboard: Current user:",s?{username:s.username,role:s.role}:null);const[k,p]=x.useState({username:"",password:"",email:"",full_name:"",role:"user"}),[S,_]=x.useState({});x.useEffect(()=>{if((s==null?void 0:s.role)!=="admin"){u("Access denied. Admin privileges required.");return}W()},[s]);const $=E=>{P(E),setTimeout(()=>P(""),3e3)},W=async()=>{try{d(!0);const E=await re.getAllUsers();l(E)}catch(E){u(E instanceof Error?E.message:"Failed to fetch users")}finally{d(!1)}},y=async E=>{E.preventDefault();try{u("");const B={...k,email:k.email||void 0,full_name:k.full_name||void 0},R=await re.createUser(B);l([...r,R]),p({username:"",password:"",email:"",full_name:"",role:"user"}),h(!1),$(`User "${R.username}" created successfully!`)}catch(B){u(B instanceof Error?B.message:"Failed to create user")}},Z=async E=>{if(E.preventDefault(),!!c)try{u("");const B=Object.entries(S).reduce((q,[le,te])=>(te!==void 0&&te!==""&&(q[le]=te),q),{}),R=await re.adminUpdateUser(c.id,B);l(r.map(q=>q.id===c.id?R:q)),j(null),_({})}catch(B){u(B instanceof Error?B.message:"Failed to update user")}},Y=async()=>{if(g)try{u(""),z(!0),await re.deleteUser(g.id),l(r.filter(E=>E.id!==g.id)),$(`User "${g.username}" deleted successfully!`),N(null)}catch(E){u(E instanceof Error?E.message:"Failed to delete user")}finally{z(!1)}},se=E=>{N(E)},ee=E=>{j(E),_({username:E.username,is_active:E.is_active,role:E.role})};return(s==null?void 0:s.role)!=="admin"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs(V,{className:"max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You need admin privileges to access this page."}),e.jsx(U,{onClick:a,variant:"tertiary",children:"Logout"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Manage users and system settings"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(U,{onClick:()=>t("/dashboard"),variant:"tertiary",className:"flex items-center",children:[e.jsx(ps,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),e.jsx(U,{onClick:()=>h(!0),variant:"primary",children:"Create User"}),e.jsx(U,{onClick:a,variant:"tertiary",children:"Logout"})]})]}),w&&e.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:typeof w=="string"?w:JSON.stringify(w)})}),C&&e.jsx("div",{className:"mb-6 rounded-md bg-green-50 p-4",children:e.jsx("div",{className:"text-sm text-green-700",children:C})}),e.jsxs(V,{className:"mb-8 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Current User"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Username"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.username})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Role"}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:s==null?void 0:s.role})]})]})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs(V,{className:"max-w-md w-full m-4 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create New User"}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx(X,{label:"Username (max 50 characters)",value:k.username,onChange:E=>{const B=E.target.value;B.length<=50&&p({...k,username:B})},maxLength:50,required:!0,placeholder:"Enter username (1-50 characters)"}),e.jsx(X,{label:"Password",type:"password",value:k.password,onChange:E=>p({...k,password:E.target.value}),required:!0}),e.jsx(X,{label:"Email (Optional)",type:"email",value:k.email,onChange:E=>p({...k,email:E.target.value})}),e.jsx(X,{label:"Full Name (Optional)",value:k.full_name,onChange:E=>p({...k,full_name:E.target.value})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:k.role,onChange:E=>p({...k,role:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(U,{type:"submit",variant:"primary",className:"flex-1",children:"Create User"}),e.jsx(U,{type:"button",variant:"tertiary",onClick:()=>h(!1),className:"flex-1",children:"Cancel"})]})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs(V,{className:"max-w-md w-full m-4 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Edit User: ",c.username]}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsx(X,{label:"Username (max 50 characters)",value:S.username||"",onChange:E=>{const B=E.target.value;B.length<=50&&_({...S,username:B})},maxLength:50,placeholder:"Enter username (1-50 characters)"}),e.jsx(X,{label:"New Password (Optional)",type:"password",value:S.password||"",onChange:E=>_({...S,password:E.target.value}),placeholder:"Leave empty to keep current password"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:S.role||c.role,onChange:E=>_({...S,role:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-musashi-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:S.is_active??c.is_active,onChange:E=>_({...S,is_active:E.target.checked}),className:"mr-2"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Active User"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(U,{type:"submit",variant:"primary",className:"flex-1",children:"Update User"}),e.jsx(U,{type:"button",variant:"tertiary",onClick:()=>j(null),className:"flex-1",children:"Cancel"})]})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs(V,{className:"max-w-md w-full m-4 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:"Delete User"}),e.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to delete user ",e.jsxs("strong",{children:['"',g.username,'"']}),"? This action cannot be undone."]}),g.email&&e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Email: ",g.email]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(U,{onClick:Y,variant:"primary",disabled:M,className:"flex-1 bg-red-600 hover:bg-red-700",children:M?"Deleting...":"Delete User"}),e.jsx(U,{type:"button",variant:"tertiary",onClick:()=>N(null),disabled:M,className:"flex-1",children:"Cancel"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"All Users"}),n?e.jsx("p",{className:"text-gray-600",children:"Loading users..."}):e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 min-w-[200px]",children:"User"}),e.jsx("th",{scope:"col",className:"px-6 py-3 min-w-[100px]",children:"Role"}),e.jsx("th",{scope:"col",className:"px-6 py-3 min-w-[100px]",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 min-w-[120px]",children:"Created"}),e.jsx("th",{scope:"col",className:"px-6 py-3 min-w-[150px]",children:"Actions"})]})}),e.jsx("tbody",{children:r.map(E=>e.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:E.username}),E.email&&e.jsx("div",{className:"text-sm text-gray-500",children:E.email})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E.role==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:E.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(E.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ee(E),className:"text-musashi-600 hover:text-musashi-900",children:"Edit"}),(()=>(console.log("Delete button check:",{userId:E.id,currentUserId:s==null?void 0:s.id,showDelete:E.id!==(s==null?void 0:s.id)}),E.id!==(s==null?void 0:s.id)&&e.jsx("button",{onClick:()=>se(E),className:"text-red-600 hover:text-red-900",children:"Delete"})))()]})})]},E.id))})]})})]})]})})},Qt=()=>{const[s,a]=x.useState(""),[t,r]=x.useState(""),l=h=>{a(h.target.value),h.target.value.length<3?r("최소 3글자 이상 입력해주세요."):r("")},n=["https://picsum.photos/400/300?random=1","https://picsum.photos/400/300?random=2","https://picsum.photos/400/300?random=3","https://picsum.photos/400/300?random=4","https://picsum.photos/400/300?random=5"],d=[{id:1,content:e.jsxs(V,{image:n[0],imageAlt:"Sample Image 1",hover:!0,children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"첫 번째 슬라이드"}),e.jsx(m,{variant:"body",color:"light",children:"아름다운 이미지와 함께하는 첫 번째 카드입니다."})]})},{id:2,content:e.jsxs(V,{image:n[1],imageAlt:"Sample Image 2",hover:!0,children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"두 번째 슬라이드"}),e.jsx(m,{variant:"body",color:"light",children:"매력적인 콘텐츠가 담긴 두 번째 카드입니다."})]})},{id:3,content:e.jsxs(V,{image:n[2],imageAlt:"Sample Image 3",hover:!0,children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"세 번째 슬라이드"}),e.jsx(m,{variant:"body",color:"light",children:"흥미로운 내용이 포함된 세 번째 카드입니다."})]})},{id:4,content:e.jsxs(V,{image:n[3],imageAlt:"Sample Image 4",hover:!0,children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"네 번째 슬라이드"}),e.jsx(m,{variant:"body",color:"light",children:"다양한 정보를 담은 네 번째 카드입니다."})]})}],o=Array.from({length:6},(h,c)=>({id:c+1,content:e.jsx(V,{variant:"outlined",className:"h-32 flex items-center justify-center",children:e.jsx(m,{variant:"h4",color:"primary",children:c+1})})}));return e.jsx("div",{className:"min-h-screen bg-white",children:e.jsxs("div",{className:"max-w-6xl mx-auto p-8",children:[e.jsxs("div",{className:"mb-12",children:[e.jsx(m,{variant:"h1",className:"mb-4",children:"Component Library"}),e.jsx(m,{variant:"body",color:"light",children:"Musashi의 디자인 시스템 컴포넌트들을 확인하고 테스트할 수 있습니다."})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Color Palette"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(i.palette).map(([h,c])=>typeof c=="string"?e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg border shadow-sm",style:{backgroundColor:c}}),e.jsxs("div",{children:[e.jsx(m,{variant:"body",weight:"medium",children:h}),e.jsx(m,{variant:"small",color:"light",children:c})]})]},h):typeof c=="object"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{variant:"body",weight:"medium",className:"capitalize",children:h}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:Object.entries(c).map(([j,g])=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 rounded border shadow-sm mb-1",style:{backgroundColor:g},title:`${h}-${j}: ${g}`}),e.jsx(m,{variant:"tiny",color:"light",children:j})]},j))})]},h):null)})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Buttons"}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Button Variants"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(U,{variant:"primary",children:"Primary Button"}),e.jsx(U,{variant:"secondary",children:"Secondary Button"}),e.jsx(U,{variant:"tertiary",children:"Tertiary Button"})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Button Sizes"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(U,{variant:"primary",size:"small",children:"Small"}),e.jsx(U,{variant:"primary",size:"medium",children:"Medium"}),e.jsx(U,{variant:"primary",size:"large",children:"Large"})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Button States"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(U,{variant:"primary",children:"Normal"}),e.jsx(U,{variant:"primary",disabled:!0,children:"Disabled"}),e.jsx(U,{variant:"primary",loading:!0,children:"Loading"})]})]})]})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Typography"}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Headings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{variant:"h1",children:"Heading 1"}),e.jsx(m,{variant:"h2",children:"Heading 2"}),e.jsx(m,{variant:"h3",children:"Heading 3"}),e.jsx(m,{variant:"h4",children:"Heading 4"})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Body Text"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{variant:"body",children:"This is regular body text. It's readable and comfortable for longer content."}),e.jsx(m,{variant:"body",weight:"medium",children:"This is medium weight body text."}),e.jsx(m,{variant:"body",weight:"semibold",children:"This is semibold body text."})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Text Colors"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{variant:"body",color:"dark",children:"Dark text color"}),e.jsx(m,{variant:"body",color:"medium",children:"Medium text color"}),e.jsx(m,{variant:"body",color:"light",children:"Light text color"}),e.jsx(m,{variant:"body",color:"primary",children:"Primary text color"})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Font Families"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{variant:"body",fontFamily:"sans",children:"Sans Serif Font"}),e.jsx(m,{variant:"body",fontFamily:"serif",children:"Serif Font"}),e.jsx(m,{variant:"body",fontFamily:"mono",children:"Monospace Font"})]})]})]})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Cards"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Basic Cards"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(V,{children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"Default Card"}),e.jsx(m,{variant:"body",color:"light",children:"This is a default card with standard padding and styling."})]}),e.jsxs(V,{variant:"outlined",children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"Outlined Card"}),e.jsx(m,{variant:"body",color:"light",children:"This card has a border outline instead of shadow."})]}),e.jsxs(V,{variant:"elevated",children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"Elevated Card"}),e.jsx(m,{variant:"body",color:"light",children:"This card has more prominent shadow for elevation."})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Image Cards"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(V,{image:n[0],imageAlt:"Beautiful landscape",hover:!0,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(m,{variant:"h4",children:"Image Card"}),e.jsx(Q,{variant:"success",children:"New"})]}),e.jsx(m,{variant:"body",color:"light",className:"mb-3",children:"이미지가 포함된 카드입니다. 호버 효과가 적용되어 있습니다."}),e.jsx(U,{variant:"primary",size:"small",children:"Learn More"})]}),e.jsxs(V,{image:n[1],imageAlt:"Urban architecture",variant:"outlined",hover:!0,imageHeight:"160px",children:[e.jsx(m,{variant:"h4",className:"mb-2",children:"Outlined Image Card"}),e.jsx(m,{variant:"body",color:"light",className:"mb-3",children:"테두리가 있는 이미지 카드입니다. 이미지 높이를 커스텀할 수 있습니다."}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(U,{variant:"secondary",size:"small",children:"View"}),e.jsx(U,{variant:"tertiary",size:"small",children:"Share"})]})]}),e.jsxs(V,{image:n[2],imageAlt:"Nature scene",variant:"elevated",hover:!0,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(m,{variant:"h4",children:"Premium Card"}),e.jsx(Q,{variant:"warning",children:"Hot"})]}),e.jsx(m,{variant:"body",color:"light",className:"mb-3",children:"고급스러운 그림자 효과가 적용된 프리미엄 카드입니다."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{variant:"small",color:"primary",weight:"semibold",children:"$29.99"}),e.jsx(U,{variant:"primary",size:"small",children:"Buy Now"})]})]})]})]})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Spacing System"}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Spacing Scale"}),Object.entries(i.spacing).map(([h,c])=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16",children:e.jsx(m,{variant:"small",color:"medium",children:h})}),e.jsx("div",{className:"bg-blue-200 h-4",style:{width:c}}),e.jsx(m,{variant:"small",color:"light",children:c})]},h))]})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Input Fields"}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Input Variants"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(X,{label:"Default Input",placeholder:"Enter your name",variant:"default"}),e.jsx(X,{label:"Outlined Input",placeholder:"Enter your email",variant:"outlined"})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Input Sizes"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(X,{label:"Small Input",placeholder:"Small size",size:"small"}),e.jsx(X,{label:"Medium Input",placeholder:"Medium size",size:"medium"}),e.jsx(X,{label:"Large Input",placeholder:"Large size",size:"large"})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Input States"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(X,{label:"Interactive Input",placeholder:"Type something...",value:s,onChange:l,error:t,helpText:"This input validates as you type"}),e.jsx(X,{label:"Disabled Input",placeholder:"Disabled state",disabled:!0,value:"Cannot edit this"})]})]})]})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Carousel"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Single Item Carousel"}),e.jsx(Re,{items:d,autoPlay:!0,autoPlayInterval:4e3,showDots:!0,showArrows:!0})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Multiple Items Carousel"}),e.jsx(Re,{items:o,itemsPerView:3,gap:20,showDots:!0,showArrows:!0})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Minimal Carousel"}),e.jsx(Re,{items:d.slice(0,3),showDots:!1,showArrows:!0,autoPlay:!0,autoPlayInterval:2e3})]})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Badges"}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Badge Variants"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(Q,{variant:"default",children:"Default"}),e.jsx(Q,{variant:"primary",children:"Primary"}),e.jsx(Q,{variant:"secondary",children:"Secondary"}),e.jsx(Q,{variant:"success",children:"Success"}),e.jsx(Q,{variant:"warning",children:"Warning"}),e.jsx(Q,{variant:"danger",children:"Danger"})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Badge Sizes"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(Q,{variant:"primary",size:"small",children:"Small"}),e.jsx(Q,{variant:"primary",size:"medium",children:"Medium"}),e.jsx(Q,{variant:"primary",size:"large",children:"Large"})]})]})]})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Navigation Bar"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Default Navbar"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(De,{})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Transparent Navbar"}),e.jsxs("div",{className:"relative rounded-lg overflow-hidden",style:{background:`linear-gradient(135deg, ${i.palette.blue[100]} 0%, ${i.palette.purple[100]} 100%)`,minHeight:"200px"},children:[e.jsx(De,{variant:"transparent"}),e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(m,{variant:"body",color:"medium",children:"Background content visible through transparent navbar"})})]})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Solid Navbar"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(De,{variant:"solid"})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Minimal Navbar"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(De,{showSearch:!1,showAuth:!1})})]})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Hero Sections"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Default Hero"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Be,{showBadge:!0,badgeText:"v2.0",subtitle:"AI-Powered Workflow Design",title:"Build Intelligent Agent Workflows Visually",description:"Create, design, and manage complex AI agent workflows without writing code. Drag, drop, and connect components to build powerful automation systems.",primaryAction:{text:"Get Started",onClick:()=>alert("Primary action clicked!")},secondaryAction:{text:"View Demo",onClick:()=>alert("Secondary action clicked!")},features:["Visual workflow builder","No-code automation","Team collaboration"]})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Centered Hero"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Be,{variant:"centered",showBadge:!0,badgeText:"New Feature",subtitle:"Musashi v2.0",title:"The Future of Workflow Design",description:"Experience the next generation of visual workflow creation with enhanced AI capabilities and seamless team collaboration.",primaryAction:{text:"Explore Features",onClick:()=>alert("Explore features!")},secondaryAction:{text:"Watch Video",onClick:()=>alert("Watch video!")},stats:[{value:"10K+",label:"Active Users"},{value:"50K+",label:"Workflows Created"},{value:"99.9%",label:"Uptime"}]})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Split Hero"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Be,{variant:"split",showBadge:!0,badgeText:"Beta",subtitle:"Workflow Design Tool",title:"Cut the Code. Shape the Flow.",description:"Musashi empowers teams to create sophisticated AI agent workflows through intuitive visual design. No programming required.",primaryAction:{text:"Start Building",onClick:()=>alert("Start building!")},secondaryAction:{text:"Learn More",onClick:()=>alert("Learn more!")},features:["Drag & drop interface","Real-time collaboration","Version control integration","Enterprise security"],stats:[{value:"5min",label:"Setup Time"},{value:"300%",label:"Faster Deployment"},{value:"24/7",label:"Support"}]})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Minimal Hero"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Be,{variant:"minimal",showBadge:!0,badgeText:"Simple",title:"Simple. Powerful. Beautiful.",description:"Sometimes less is more. Create beautiful workflows with our minimal design approach.",primaryAction:{text:"Get Started",onClick:()=>alert("Get started!")},secondaryAction:{text:"Learn More",onClick:()=>alert("Learn more!")}})})]})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Footer"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Default Footer"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Ve,{})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Detailed Footer"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Ve,{variant:"detailed"})})]}),e.jsxs("div",{children:[e.jsx(m,{variant:"h3",className:"mb-4",children:"Minimal Footer"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:i.theme.colorBorder},children:e.jsx(Ve,{variant:"minimal"})})]})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(m,{variant:"h2",className:"mb-6",children:"Border Radius"}),e.jsx(V,{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(i.borderRadius).map(([h,c])=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 border border-blue-200 mx-auto mb-2",style:{borderRadius:c}}),e.jsx(m,{variant:"small",weight:"medium",children:h}),e.jsx(m,{variant:"tiny",color:"light",children:c})]},h))})})]})]})})},Yt=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"React Flow Test Environment"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Testing workflow editor components without authentication"}),e.jsx(Qe,{})]})}),Xt=new Fs;function ea(){return e.jsx(Us,{client:Xt,children:e.jsx(Zs,{children:e.jsx(Rs,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs(Vs,{children:[e.jsx(oe,{path:"/login",element:e.jsx(Gt,{})}),e.jsx(oe,{path:"/",element:e.jsx(fe,{children:e.jsx(qe,{to:"/dashboard",replace:!0})})}),e.jsx(oe,{path:"/dashboard",element:e.jsx(fe,{children:e.jsx(ft,{})})}),e.jsx(oe,{path:"/admin",element:e.jsx(fe,{requireAdmin:!0,children:e.jsx(Jt,{})})}),e.jsx(oe,{path:"/workflow/new",element:e.jsx(fe,{children:e.jsx(Qe,{})})}),e.jsx(oe,{path:"/workflow/:id",element:e.jsx(fe,{children:e.jsx(Qe,{})})}),e.jsx(oe,{path:"/components",element:e.jsx(fe,{children:e.jsx(Qt,{})})}),e.jsx(oe,{path:"/shared/:shareToken",element:e.jsx(Yt,{})})]})})})})})}qs.createRoot(document.getElementById("root")).render(e.jsx(Ye.StrictMode,{children:e.jsx(ea,{})}));
//# sourceMappingURL=index-46f89e17.js.map
